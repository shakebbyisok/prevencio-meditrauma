{% extends 'theme/template.html.twig' %}
{% trans_default_domain 'empresas' %}
{% block javascripts %}
    {{ parent() }}
    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/css/select2.min.css" rel="stylesheet" />
    <script src="{{ asset('js/custom.js') }}"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.min.js"></script>
{% endblock %}
{% block arrow %}<a href="{{ path('tecnico_empresa_show') }}" style="color: black;"><i class="icon-arrow-left52 mr-2"></i></a>{% endblock %}
{% block title %} {% trans %}TRANS_EMPRESA{% endtrans %} {% endblock %}
{% block subtitle %}
    {% if (app.request.get('id') is defined and app.request.get('id') is not empty ) %}
        {{ form.vars.value.empresa }}
    {% else %}
        {% trans from 'messages' %}TRANS_NUEVA{% endtrans %}
    {% endif %}
{% endblock %}

{% block card %}

    <style>
        .custom-file-label { opacity: 0; }
        .custom-file-input { opacity: 1; }
    </style>

    <script src="{{ asset('jstree/jstree.min.js') }}"></script>
    <link href="{{ asset('jstree/themes/default/style.min.css') }}" rel="stylesheet" type="text/css">


    <script type="text/javascript">
        $(document).ready(function(){

            $('.summernote').summernote();

            var arrayDataTrabajadores = [];
            var arrayDataAccidentes = [];
            var arrayDataEvaluaciones = [];
            var arrayDataMaquinas = [];
            var arrayDataPlanPrevencion = [];
            var arrayDataProtocoloAcoso = [];
            var arrayDataMaquinasGenericasPuestoTrabajo = [];
            var arrayDataMaquinasGenericasZonaTrabajo = [];
            var arrayDataMaquinasEmpresaPuestoTrabajo = [];
            var arrayDataMaquinasEmpresaZonaTrabajo = [];
            var arrayDataTarifasRevisionesMedicas = [];
            var arrayDataHojasActuacion = [];

            $.extend( $.fn.dataTable.defaults, {
                autoWidth: true,
                columnDefs: [{
                    width: 100,
                }],
                ordering: true,
                deferRender: false,
                dom: '<"datatable-header"fBl><"datatable-scroll-wrap"t><"datatable-footer"ip>',
                language: {
                    search: '<span>Filtrar:</span> _INPUT_',
                    searchPlaceholder: 'Escriba para filtrar...',
                    lengthMenu: '<span>Mostrar:</span> _MENU_',
                    paginate: { 'first': 'First', 'last': 'Last', 'next': $('html').attr('dir') == 'rtl' ? '&larr;' : '&rarr;', 'previous': $('html').attr('dir') == 'rtl' ? '&rarr;' : '&larr;' }
                },
            });

            {% for te in trabajadoresEmpresa %}
            var array = [];
            var actions = '<div class="list-icons">';

            {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn is defined and app.session.get('privilegiosRol').editEmpresaTecnicoSn is not null and impagadaSn is defined and impagadaSn == false %}
            {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn %}
            {% if te.trabajadorid is defined and te.trabajadorid is not empty %}
            actions += '<a href="{{ path('tecnico_trabajador_update', { "id": te.trabajadorid }) }}" target="_blank" class="list-icons-item" data-popup="tooltip" title="Editar" data-container="body"><i class="icon-pencil7"></i></a>';
            {% endif %}
            {% endif %}
            {% endif %}

            {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn is defined and app.session.get('privilegiosRol').editEmpresaTecnicoSn is not null %}
            {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn and impagadaSn is defined and impagadaSn == false %}

            {% endif %}
            {% endif %}

            actions += '</div>';

            var estado = '<span class="badge badge-success">{% trans from 'trabajadores' %}TRANS_ACTIVO{% endtrans %}</span>';
            {% if te.activo == false %}
            estado = '<span class="badge badge-danger">{% trans from 'trabajadores' %}TRANS_NO_ACTIVO{% endtrans %}</span>';
            {% endif %}

            array.push(estado, '{{ te.trabajador }}', '{{ te.dni }}', '{{ te.puesto }}', actions);
            arrayDataTrabajadores.push(array);
            {% endfor %}

            $('.datatable-export-excel-trabajadores').DataTable({
                data: arrayDataTrabajadores,
                order: [[1, "asc"]],
                buttons: {
                    buttons: [
                        {
                            extend: 'excelHtml5',
                            className: 'btn btn-success',
                            text: '<i class="icon-file-spreadsheet mr-2"></i> Exportar a Excel',
                            fieldSeparator: '\t',
                            extension: '.xlsx'
                        }
                    ]
                }
            });

            {% if app.session.get('privilegiosRol').exportEmpresaTecnicoSn is defined and app.session.get('privilegiosRol').exportEmpresaTecnicoSn is not null %}
            {% if app.session.get('privilegiosRol').exportEmpresaTecnicoSn != true %}
            $('#datatable-trabajadores .dt-buttons').css('display', 'none');
            {% endif %}
            {% endif %}

            {% for ae in accidentesEmpresa %}
            var array = [];
            var actions = '<div class="list-icons">';

            {% if ae.fichero is not null %}
            actions += '<a href="{{ path('gdoc_open_file', { "fileId": ae.fichero.id, "tipo": "6" }) }}" class="list-icons-item" target="_blank" data-popup="tooltip" title="Imprimir" data-container="body"><i class="icon-printer2"></i></a>';
            {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn is defined and app.session.get('privilegiosRol').editEmpresaTecnicoSn is not null %}
            {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn and impagadaSn is defined and impagadaSn == false %}
            actions += '<a href="#" data-id="{{ ae.fichero.id }}" target="_self" class="list-icons-item eliminarFicheroAccidente"><i class="icon-trash"></i></a>';
            {% endif %}
            {% endif %}
            {% endif %}

            actions += '</div>';

            array.push('{{ ae.trabajador.nombre }}', '{{ ae.fecha|date('d/m/Y') }}', actions);
            arrayDataAccidentes.push(array);
            {% endfor %}

            $('.datatable-export-excel-accidentes').DataTable({
                data: arrayDataAccidentes,
                buttons: {
                    buttons: [
                        {
                            extend: 'excelHtml5',
                            className: 'btn btn-success',
                            text: '<i class="icon-file-spreadsheet mr-2"></i> Exportar a Excel',
                            fieldSeparator: '\t',
                            extension: '.xlsx'
                        }
                    ]
                }
            });

            {% if app.session.get('privilegiosRol').exportEmpresaTecnicoSn is defined and app.session.get('privilegiosRol').exportEmpresaTecnicoSn is not null %}
            {% if app.session.get('privilegiosRol').exportEmpresaTecnicoSn != true %}
            $('#datatable-accidentes .dt-buttons').css('display', 'none');
            {% endif %}
            {% endif %}

            {% for pp in planPrevencion %}
            var array = [];
            var actions = '<div class="list-icons">';

            {% if pp.fichero_id is not null %}
            {% if app.session.get('privilegiosRol').printPlanPrevencionSn is defined and app.session.get('privilegiosRol').printPlanPrevencionSn is not null %}
            {% if app.session.get('privilegiosRol').printPlanPrevencionSn and impagadaSn is defined and impagadaSn == false %}
            actions += '<a href="{{ path('gdoc_open_file', { "fileId": pp.fichero_id, "tipo": "8" }) }}" class="list-icons-item" target="_blank" data-popup="tooltip" title="Imprimir" data-container="body"><i class="icon-printer2"></i></a>';
            {% endif %}
            {% endif %}
            {% if app.session.get('privilegiosRol').deletePlanPrevencionSn is defined and app.session.get('privilegiosRol').deletePlanPrevencionSn is not null %}
            {% if app.session.get('privilegiosRol').deletePlanPrevencionSn and impagadaSn is defined and impagadaSn == false %}
            actions += '<a href="#" data-id="{{ pp.fichero_id }}" target="_self" class="list-icons-item eliminarFicheroPlanPrevencion"><i class="icon-trash"></i></a>';
            {% endif %}
            {% endif %}
            {% endif %}

            array.push('{{ pp.fecha|date('d/m/Y') }}','{{ pp.numero }}', actions);
            arrayDataPlanPrevencion.push(array);
            {% endfor %}

            $('.datatable-export-excel-plan-prevencion').DataTable({
                data: arrayDataPlanPrevencion,
                buttons: {
                    buttons: [
                        {
                            extend: 'excelHtml5',
                            className: 'btn btn-success',
                            text: '<i class="icon-file-spreadsheet mr-2"></i> Exportar a Excel',
                            fieldSeparator: '\t',
                            extension: '.xlsx'
                        }
                    ]
                }
            });

            {% if app.session.get('privilegiosRol').exportPlanPrevencionSn is defined and app.session.get('privilegiosRol').exportPlanPrevencionSn is not null %}
            {% if app.session.get('privilegiosRol').exportPlanPrevencionSn != true %}
            $('#datatable-plan-prevencion .dt-buttons').css('display', 'none');
            {% endif %}
            {% endif %}

            {% for pa in protocoloAcoso %}
            var array = [];
            var actions = '<div class="list-icons">';

            {% if pa.fichero is not null %}
            {% if app.session.get('privilegiosRol').printProtocoloAcosoSn is defined and app.session.get('privilegiosRol').printProtocoloAcosoSn is not null %}
            {% if app.session.get('privilegiosRol').printProtocoloAcosoSn and impagadaSn is defined and impagadaSn == false %}
            actions += '<a href="{{ path('gdoc_open_file', { "fileId": pa.fichero.id, "tipo": "19" }) }}" class="list-icons-item" target="_blank" data-popup="tooltip" title="Imprimir" data-container="body"><i class="icon-printer2"></i></a>';
            {% endif %}
            {% endif %}
            {% if app.session.get('privilegiosRol').deleteProtocoloAcosoSn is defined and app.session.get('privilegiosRol').deleteProtocoloAcosoSn is not null %}
            {% if app.session.get('privilegiosRol').deleteProtocoloAcosoSn and impagadaSn is defined and impagadaSn == false %}
            actions += '<a href="#" data-id="{{ pa.fichero.id }}" target="_self" class="list-icons-item eliminarFicheroProtocoloAcoso"><i class="icon-trash"></i></a>';
            {% endif %}
            {% endif %}
            {% endif %}

            array.push('{{ pa.fecha|date('d/m/Y') }}', actions);
            arrayDataProtocoloAcoso.push(array);
            {% endfor %}

            $('.datatable-export-excel-protocolo-acoso').DataTable({
                data: arrayDataProtocoloAcoso,
                buttons: {
                    buttons: [
                        {
                            extend: 'excelHtml5',
                            className: 'btn btn-success',
                            text: '<i class="icon-file-spreadsheet mr-2"></i> Exportar a Excel',
                            fieldSeparator: '\t',
                            extension: '.xlsx'
                        }
                    ]
                }
            });

            {% if app.session.get('privilegiosRol').exportProtocoloAcosoSn is defined and app.session.get('privilegiosRol').exportProtocoloAcosoSn is not null %}
            {% if app.session.get('privilegiosRol').exportProtocoloAcosoSn != true %}
            $('#datatable-protocolo-acoso .dt-buttons').css('display', 'none');
            {% endif %}
            {% endif %}

            {% for evaluacion in evaluaciones %}
            var array = [];
            var actions = '<div class="list-icons">';

            {% if app.session.get('privilegiosRol').editEvaluacionSn is defined and app.session.get('privilegiosRol').editEvaluacionSn is not null %}
            {% if app.session.get('privilegiosRol').editEvaluacionSn and impagadaSn is defined and impagadaSn == false %}
            actions += '<a href="{{ path('tecnico_evaluaciones_evaluacion_update', { "id": evaluacion.id }) }}" class="list-icons-item" data-popup="tooltip" title="Editar" data-container="body"><i class="icon-pencil7"></i></a>';
            {% endif %}
            {% endif %}

            {% if app.session.get('privilegiosRol').deleteEvaluacionSn is defined and app.session.get('privilegiosRol').deleteEvaluacionSn is not null %}
            {% if app.session.get('privilegiosRol').deleteEvaluacionSn and impagadaSn is defined and impagadaSn == false %}
            actions += '<a href="{{ path('tecnico_evaluaciones_evaluacion_delete', { "id": evaluacion.id }) }}" class="list-icons-item" data-popup="tooltip" title="Eliminar" data-container="body" onclick="return confirm(\'{% trans from 'messages' %}TRANS_CONFIRM_DELETE_REGISTRO{% endtrans %}\');"><i class="icon-trash"></i></a>';
            {% endif %}
            {% endif %}

            actions += '</div>';
            //Peticio 28/07/2023 Codis avaluacions risocos laborals - Mejora continua #63749
            array.push('{{ evaluacion.centros }}', '{{ evaluacion.numero }}','{{ evaluacion.fechainicio }}', '{{ evaluacion.fechafin }}', '{{ evaluacion.tipo }}', '{{ evaluacion.metodologia }}', actions);
            arrayDataEvaluaciones.push(array);
            {% endfor %}

            $('.datatable-export-excel-evaluaciones').DataTable({
                data: arrayDataEvaluaciones,
                buttons: {
                    buttons: [
                        {
                            extend: 'excelHtml5',
                            className: 'btn btn-success',
                            text: '<i class="icon-file-spreadsheet mr-2"></i> Exportar a Excel',
                            fieldSeparator: '\t',
                            extension: '.xlsx'
                        }
                    ]
                }
            });

            {% if app.session.get('privilegiosRol').exportEvaluacionSn is defined and app.session.get('privilegiosRol').exportEvaluacionSn is not null %}
            {% if app.session.get('privilegiosRol').exportEvaluacionSn != true %}
            $('#datatable-evaluaciones .dt-buttons').css('display', 'none');
            {% endif %}
            {% endif %}

            {% for m in maquinas %}
            var array = [];
            var actions = '<div class="list-icons">';

            {% if app.session.get('privilegiosRol').editMaquinaEmpresaSn is defined and app.session.get('privilegiosRol').editMaquinaEmpresaSn is not null %}
            {% if app.session.get('privilegiosRol').editMaquinaEmpresaSn and impagadaSn is defined and impagadaSn == false %}
            actions += '<a href="{{ path('tecnico_empresa_maquina_update', { "id": m.id }) }}"" target="_self" class="list-icons-item"><i class="icon-pencil7"></i></a>';
            {% endif %}
            {% endif %}

            {% if app.session.get('privilegiosRol').deleteMaquinaEmpresaSn is defined and app.session.get('privilegiosRol').deleteMaquinaEmpresaSn is not null %}
            {% if app.session.get('privilegiosRol').deleteMaquinaEmpresaSn and impagadaSn is defined and impagadaSn == false %}
            actions += '<a href="#" data-id="{{ m.id }}" target="_self" class="list-icons-item eliminarMaquinaEmpresa"><i class="icon-trash"></i></a>';
            {% endif %}
            {% endif %}

            actions += '</div>';

            var grupo = '';
            var generica = '';
            var centr = '';
            {% if m.grupoMaquina is not null %}
            grupo = '{{ m.grupoMaquina.descripcion }}';
            {% endif %}

            {% if m.maquinaGenerica is not null %}
            generica = '{{ m.maquinaGenerica.descripcion }}';
            {% endif %}
            {% if m.centro is not null %}
            centr = '{{ m.centro.nombre }}';
            {% endif %}

            array.push(centr, '{{ m.descripcion }}', grupo, generica, actions);
            arrayDataMaquinas.push(array);
            {% endfor %}

            $('.datatable-export-excel-maquinaria').DataTable({
                data: arrayDataMaquinas,
                buttons: {
                    buttons: [
                        {
                            extend: 'excelHtml5',
                            className: 'btn btn-success',
                            text: '<i class="icon-file-spreadsheet mr-2"></i> Exportar a Excel',
                            fieldSeparator: '\t',
                            extension: '.xlsx'
                        }
                    ]
                }
            });

            {% if app.session.get('privilegiosRol').exportMaquinaEmpresaSn is defined and app.session.get('privilegiosRol').exportMaquinaEmpresaSn is not null %}
            {% if app.session.get('privilegiosRol').exportMaquinaEmpresaSn != true %}
            $('#datatable-maquinaria .dt-buttons').css('display', 'none');
            {% endif %}
            {% endif %}

            {% for maquinaGenericaPuestoTrabajo in maquinasGenericasPuestoTrabajo %}
            var array = [];
            var actions = '<div class="list-icons">';

            {% if app.session.get('privilegiosRol').deleteMaquinaEmpresaSn is defined and app.session.get('privilegiosRol').deleteMaquinaEmpresaSn is not null %}
            {% if app.session.get('privilegiosRol').deleteMaquinaEmpresaSn %}
            actions += '<a href="#" data-id="{{ maquinaGenericaPuestoTrabajo.id }}" target="_self" class="list-icons-item eliminarMaquinaGenerica"><i class="icon-trash"></i></a>';
            {% endif %}
            {% endif %}

            array.push('{{ maquinaGenericaPuestoTrabajo.puestoTrabajo.descripcion }}', '{{ maquinaGenericaPuestoTrabajo.maquinaGenerica.descripcion }}', actions);
            arrayDataMaquinasGenericasPuestoTrabajo.push(array);
            {% endfor %}

            $('.datatable-export-excel-maquinas-genericas-puesto-trabajo').DataTable({
                data: arrayDataMaquinasGenericasPuestoTrabajo,
                buttons: {
                    buttons: [
                        {
                            extend: 'excelHtml5',
                            className: 'btn btn-success',
                            text: '<i class="icon-file-spreadsheet mr-2"></i> Exportar a Excel',
                            fieldSeparator: '\t',
                            extension: '.xlsx'
                        }
                    ]
                }
            });

            {% if app.session.get('privilegiosRol').exportMaquinaEmpresaSn is defined and app.session.get('privilegiosRol').exportMaquinaEmpresaSn is not null %}
            {% if app.session.get('privilegiosRol').exportMaquinaEmpresaSn != true %}
            $('#datatable-maquinas-genericas-puesto-trabajo .dt-buttons').css('display', 'none');
            {% endif %}
            {% endif %}

            {% for maquinaGenericaZonaTrabajo in maquinasGenericasZonaTrabajo %}
            var array = [];
            var actions = '<div class="list-icons">';

            {% if app.session.get('privilegiosRol').deleteMaquinaEmpresaSn is defined and app.session.get('privilegiosRol').deleteMaquinaEmpresaSn is not null %}
            {% if app.session.get('privilegiosRol').deleteMaquinaEmpresaSn %}
            actions += '<a href="#" data-id="{{ maquinaGenericaZonaTrabajo.id }}" target="_self" class="list-icons-item eliminarMaquinaGenericaZonaTrabajo"><i class="icon-trash"></i></a>';
            {% endif %}
            {% endif %}

            array.push('{{ maquinaGenericaZonaTrabajo.zonaTrabajo.descripcion }}', '{{ maquinaGenericaZonaTrabajo.maquinaGenerica.descripcion }}', actions);
            arrayDataMaquinasGenericasZonaTrabajo.push(array);
            {% endfor %}

            $('.datatable-export-excel-maquinas-genericas-zona-trabajo').DataTable({
                data: arrayDataMaquinasGenericasZonaTrabajo,
                buttons: {
                    buttons: [
                        {
                            extend: 'excelHtml5',
                            className: 'btn btn-success',
                            text: '<i class="icon-file-spreadsheet mr-2"></i> Exportar a Excel',
                            fieldSeparator: '\t',
                            extension: '.xlsx'
                        }
                    ]
                }
            });

            {% if app.session.get('privilegiosRol').exportMaquinaEmpresaSn is defined and app.session.get('privilegiosRol').exportMaquinaEmpresaSn is not null %}
            {% if app.session.get('privilegiosRol').exportMaquinaEmpresaSn != true %}
            $('#datatable-maquinas-genericas-zona-trabajo .dt-buttons').css('display', 'none');
            {% endif %}
            {% endif %}

            {% for maquinaEmpresaPuestoTrabajo in maquinasEmpresaPuestoTrabajo %}
            var array = [];
            var actions = '<div class="list-icons">';

            {% if app.session.get('privilegiosRol').deleteMaquinaEmpresaSn is defined and app.session.get('privilegiosRol').deleteMaquinaEmpresaSn is not null %}
            {% if app.session.get('privilegiosRol').deleteMaquinaEmpresaSn %}
            actions += '<a href="#" data-id="{{ maquinaEmpresaPuestoTrabajo.id }}" target="_self" class="list-icons-item eliminarMaquinaEmpresa"><i class="icon-trash"></i></a>';
            {% endif %}
            {% endif %}

            array.push('{{ maquinaEmpresaPuestoTrabajo.puestoTrabajo.descripcion }}', '{{ maquinaEmpresaPuestoTrabajo.maquinaEmpresa.descripcion }}', actions);
            arrayDataMaquinasEmpresaPuestoTrabajo.push(array);
            {% endfor %}

            $('.datatable-export-excel-maquinas-empresa-puesto-trabajo').DataTable({
                data: arrayDataMaquinasEmpresaPuestoTrabajo,
                buttons: {
                    buttons: [
                        {
                            extend: 'excelHtml5',
                            className: 'btn btn-success',
                            text: '<i class="icon-file-spreadsheet mr-2"></i> Exportar a Excel',
                            fieldSeparator: '\t',
                            extension: '.xlsx'
                        }
                    ]
                }
            });
            {% for ae in hojaActu %}
            var array = [];
            var actions = '<div class="list-icons">';
            actions += '<a href="#" data-id="{{ ae.id }}" target="_self" class="list-icons-item editarFichero"><i class="icon-pencil7"></i></a>';
            array.push('{{ ae.nombreCompleto }}','{{ ae.fechaProxVisita|date('d/m/Y') }}', '{{ ae.observaciones }}',actions);
            arrayDataHojasActuacion.push(array);
            {% endfor %}
            $('.datatable-export-excel-hojasactuacion').DataTable({
                data: arrayDataHojasActuacion,
                buttons: {
                    buttons: [
                        {
                            extend: 'excelHtml5',
                            className: 'btn btn-success',
                            text: '<i class="icon-file-spreadsheet mr-2"></i> Exportar a Excel',
                            fieldSeparator: '\t',
                            extension: '.xlsx'
                        }
                    ]
                }
            });
            {% if app.session.get('privilegiosRol').exportMaquinaEmpresaSn is defined and app.session.get('privilegiosRol').exportMaquinaEmpresaSn is not null %}
            {% if app.session.get('privilegiosRol').exportMaquinaEmpresaSn != true %}
            $('#datatable-maquinas-empresa-puesto-trabajo .dt-buttons').css('display', 'none');
            {% endif %}
            {% endif %}

            {% for maquinaEmpresaZonaTrabajo in maquinasEmpresaZonaTrabajo %}
            var array = [];
            var actions = '<div class="list-icons">';

            {% if app.session.get('privilegiosRol').deleteMaquinaEmpresaSn is defined and app.session.get('privilegiosRol').deleteMaquinaEmpresaSn is not null %}
            {% if app.session.get('privilegiosRol').deleteMaquinaEmpresaSn %}
            actions += '<a href="#" data-id="{{ maquinaEmpresaZonaTrabajo.id }}" target="_self" class="list-icons-item eliminarMaquinaEmpresaZonaTrabajo"><i class="icon-trash"></i></a>';
            {% endif %}
            {% endif %}

            array.push('{{ maquinaEmpresaZonaTrabajo.zonaTrabajo.descripcion }}', '{{ maquinaEmpresaZonaTrabajo.maquinaEmpresa.descripcion }}', actions);
            arrayDataMaquinasEmpresaZonaTrabajo.push(array);
            {% endfor %}

            $('.datatable-export-excel-maquinas-empresa-zona-trabajo').DataTable({
                data: arrayDataMaquinasEmpresaZonaTrabajo,
                buttons: {
                    buttons: [
                        {
                            extend: 'excelHtml5',
                            className: 'btn btn-success',
                            text: '<i class="icon-file-spreadsheet mr-2"></i> Exportar a Excel',
                            fieldSeparator: '\t',
                            extension: '.xlsx'
                        }
                    ]
                }
            });

            {% if app.session.get('privilegiosRol').exportMaquinaEmpresaSn is defined and app.session.get('privilegiosRol').exportMaquinaEmpresaSn is not null %}
            {% if app.session.get('privilegiosRol').exportMaquinaEmpresaSn != true %}
            $('#datatable-maquinas-empresa-zona-trabajo .dt-buttons').css('display', 'none');
            {% endif %}
            {% endif %}

            {% for tarifaRevisionesMedicas in tarifasRevisionesMedicas %}
            var array = [];

            array.push('{{ tarifaRevisionesMedicas.concepto.descripcion }}', '{{ tarifaRevisionesMedicas.iva|number_format(2, ",", ".") }} €', '{{ tarifaRevisionesMedicas.importe|number_format(2, ",", ".") }} €');
            arrayDataTarifasRevisionesMedicas.push(array);
            {% endfor %}

            $('.datatable-export-excel-tarifas-revisiones').DataTable({
                data: arrayDataTarifasRevisionesMedicas,
                buttons: {
                    buttons: [
                        {
                            extend: 'excelHtml5',
                            className: 'btn btn-success',
                            text: '<i class="icon-file-spreadsheet mr-2"></i> Exportar a Excel',
                            fieldSeparator: '\t',
                            extension: '.xlsx'
                        }
                    ]
                }
            });

            $('#datatable-tarifas-revisiones .dt-buttons').css('display', 'none');

            //Boton para añadir un cnae
            $('#btnAddCnae').click(function(){

                if($('#cnaeValor').val() == ''){
                    $('#cnaeValor').focus();
                    return false;
                }

                $('#btnAddCnae').prop("disabled", true);
                $('#btnAddCnae').html("<i class=\"icon-spinner2 spinner mr-2\"></i>{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}");

                $.ajax({
                    type: "POST",
                    url: "{{ path('empresa_add_cnae') }}",
                    data: {
                        'cnaeId': $('#cnaeValor').val(),
                        'principal': $('#principal').is(':checked'),
                        'empresaId': '{{ app.request.get('id') }}'
                    },
                    dataType: "JSON",
                    success: function (data) {

                        if(data == "OK"){

                            recuperaCnaes();

                            $('#btnAddCnae').prop("disabled", false);
                            $('#btnAddCnae').html("{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}");

                            $('#cnaeValor').val("").change();
                            $('#funcion').val("");

                            new PNotify({
                                title: '{% trans from "messages" %}TRANS_AVISO_AÑADIDO{% endtrans %}',
                                text: '{% trans from "messages" %}TRANS_AVISO_AÑADIDO_MSG{% endtrans %}',
                                icon: 'icon-checkmark3',
                                type: 'success'
                            });

                        }
                    },
                    error: function(){
                        new PNotify({
                            title: 'Ops!',
                            text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                            icon: 'icon-blocked',
                            type: 'error'
                        });

                        $('#btnAddCnae').prop("disabled", false);
                        $('#btnAddCnae').html("{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}");
                    }
                });
            });

            //Boton para editar un cnae
            $('#btnUpdateCnae').click(function(){

                if($('#cnaeValorEditar').val() == ''){
                    $('#cnaeValorEditar').focus();
                    return false;
                }

                $('#btnUpdateCnae').prop("disabled", true);
                $('#btnUpdateCnae').html("<i class=\"icon-spinner2 spinner mr-2\"></i>Guardar");

                $.ajax({
                    type: "POST",
                    url: "{{ path('empresa_update_cnae') }}",
                    data: {
                        'cnaeId': $('#cnaeValorEditar').val(),
                        'principal': $('#principalEditar').is(':checked'),
                        'cnaeEmpresaId': $('#cnaeEmpresaIdEditar').val()
                    },
                    dataType: "JSON",
                    success: function (data) {

                        if(data == "OK"){

                            recuperaCnaes();

                            $('#btnUpdateCnae').prop("disabled", false);
                            $('#btnUpdateCnae').html("Guardar");

                            $('#cnaeValorEditar').val("").change();
                            $('#principalEditar').val("");

                            new PNotify({
                                title: '{% trans from "messages" %}TRANS_AVISO_AÑADIDO{% endtrans %}',
                                text: '{% trans from "messages" %}TRANS_AVISO_AÑADIDO_MSG{% endtrans %}',
                                icon: 'icon-checkmark3',
                                type: 'success'
                            });

                        }
                    },
                    error: function(){
                        new PNotify({
                            title: 'Ops!',
                            text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                            icon: 'icon-blocked',
                            type: 'error'
                        });

                        $('#btnUpdateCnae').prop("disabled", false);
                        $('#btnUpdateCnae').html("Guardar");
                    }
                });
            });

            // Format displayed data
            function formatRepo (repo) {
                if (repo.loading) return repo.text;

                var markup = '<div class="clearfix">' +
                    '<div>' + repo.descripcion + '</div>' +
                    '</div>';

                return markup;
            }

            // Format selection
            function formatRepoSelection (repo) {
                return repo.full_name || repo.text;
            }

            // Initialize
            $('.js_busca_ajax_centro').select2({
                ajax: {
                    url: "{{ path('busca_ajax_query',{ 'option': 'centroTrabajo' }) }}",
                    dataType: 'json',
                    delay: 250,
                    data: function (params) {
                        return {
                            q: params.term, // search term
                            page: params.page
                        };
                    },
                    processResults: function (data, params) {

                        var select2Data = $.map(JSON.parse(data), function (obj) {
                            obj.id = parseInt(obj.id);
                            obj.text = obj.descripcion;

                            return obj;
                        });

                        return {
                            results: select2Data
                        };
                    },
                    cache: true
                },
                escapeMarkup: function (markup) { return markup; }, // let our custom formatter work
                minimumInputLength: 3,
                templateResult: formatRepo, // omitted for brevity, see the source of this page
                templateSelection: formatRepoSelection // omitted for brevity, see the source of this page
            });

            $('.js_busca_ajax_trabajador').select2({
                ajax: {
                    url: "{{ path('busca_ajax_query',{ 'option': 'trabajadorEmpresa' }) }}",
                    dataType: 'json',
                    delay: 250,
                    data: function (params) {
                        return {
                            q: params.term, // search term
                            page: params.page
                        };
                    },
                    processResults: function (data, params) {

                        var select2Data = $.map(JSON.parse(data), function (obj) {
                            obj.id = parseInt(obj.id);
                            obj.text = obj.descripcion;

                            return obj;
                        });

                        return {
                            results: select2Data
                        };
                    },
                    cache: true
                },
                escapeMarkup: function (markup) { return markup; }, // let our custom formatter work
                minimumInputLength: 3,
                templateResult: formatRepo, // omitted for brevity, see the source of this page
                templateSelection: formatRepoSelection // omitted for brevity, see the source of this page
            });

            //Boton para añadir un centro de trabajo
            $('#btnAddCentroTrabajoEmpresa').click(function(){

                if($('#centroTrabajo').val() == ''){
                    $('#centroTrabajo').focus();
                    return false;
                }

                $('#btnAddCentroTrabajoEmpresa').prop("disabled", true);
                $('#btnAddCentroTrabajoEmpresa').html("<i class=\"icon-spinner2 spinner mr-2\"></i>{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}");

                $.ajax({
                    type: "POST",
                    url: "{{ path('empresa_add_centro_trabajo_empresa') }}",
                    data: {
                        'centroTrabajoId': $('#centroTrabajo').val(),
                    },
                    dataType: "JSON",
                    success: function (data) {

                        if(data == "OK"){

                            recuperaCentroTrabajo();

                            $('#btnAddCentroTrabajoEmpresa').prop("disabled", false);
                            $('#btnAddCentroTrabajoEmpresa').html("{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}");

                            $('#btnAddCentroTrabajoEmpresa').val("").change();

                            new PNotify({
                                title: '{% trans from "messages" %}TRANS_AVISO_AÑADIDO{% endtrans %}',
                                text: '{% trans from "messages" %}TRANS_AVISO_AÑADIDO_MSG{% endtrans %}',
                                icon: 'icon-checkmark3',
                                type: 'success'
                            });

                        }
                    },
                    error: function(){
                        new PNotify({
                            title: 'Ops!',
                            text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                            icon: 'icon-blocked',
                            type: 'error'
                        });

                        $('#btnAddCentroTrabajoEmpresa').prop("disabled", false);
                        $('#btnAddCentroTrabajoEmpresa').html("{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}");
                    }
                });
            });

            //Boton para añadir un trabajador
            $('#btnAddTrabajador').click(function(){

                if($('#trabajadorEmpresa').val() == ''){
                    $('#trabajadorEmpresa').focus();
                    return false;
                }

                $('#btnAddTrabajador').prop("disabled", true);
                $('#btnAddTrabajador').html("<i class=\"icon-spinner2 spinner mr-2\"></i>{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}");

                $.ajax({
                    type: "POST",
                    url: "{{ path('empresa_add_trabajador_empresa') }}",
                    data: {
                        'trabajadorId': $('#trabajadorEmpresa').val(),
                    },
                    dataType: "JSON",
                    success: function (data) {

                        if(data == "OK"){
                            location.reload();
                        }
                    },
                    error: function(){
                        new PNotify({
                            title: 'Ops!',
                            text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                            icon: 'icon-blocked',
                            type: 'error'
                        });

                        $('#btnAddTrabajador').prop("disabled", false);
                        $('#btnAddTrabajador').html("{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}");
                    }
                });

            });

            //Boton para añadir puesto de trabajo multiple
            $('#btnAddPuestoTrabajoMultiple').click(function(){

                if($('#puestoPuestoTrabajoMultiple').val() == ''){
                    $('#puestoPuestoTrabajoMultiple').focus();
                    return false;
                }

                if($('#trabajadorPuestoTrabajoMultiple').val() == ''){
                    $('#trabajadorPuestoTrabajoMultiple').focus();
                    return false;
                }

                $('#btnAddPuestoTrabajoMultiple').prop("disabled", true);
                $('#btnAddPuestoTrabajoMultiple').html("<i class=\"icon-spinner2 spinner mr-2\"></i>{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}");

                $.ajax({
                    type: "POST",
                    url: "{{ path('tecnico_empresa_asignar_puesto_trabajo_trabajador_multiple') }}",
                    data: {
                        'trabajadoresId': $('#trabajadorPuestoTrabajoMultiple').val(),
                        'puestoTrabajoId': $('#puestoPuestoTrabajoMultiple').val()
                    },
                    dataType: "JSON",
                    success: function (data) {
                        if(data == "OK"){
                            location.reload();
                        }
                    },
                    error: function(){
                        new PNotify({
                            title: 'Ops!',
                            text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                            icon: 'icon-blocked',
                            type: 'error'
                        });

                        $('#btnAddPuestoTrabajoMultiple').prop("disabled", false);
                        $('#btnAddPuestoTrabajoMultiple').html("{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}");
                    }
                });

            });

            //Validación del CIF de empresa
            $('#empresa_tecnico_cif').focusout(function(){
                var cif = $(this).val();
                if(isValidCif(cif)){
                    $.ajax({
                        type: "POST",
                        url: "{{ path('empresa_comprueba_cif') }}",
                        data: {
                            'cif': cif,
                            'empresaId': '{{ app.request.get('id') }}'
                        },
                        dataType: "JSON",
                        success: function (data) {
                            if(data == "1"){
                                $('#empresa_tecnico_cif').removeClass('border-success');
                                $('#empresa_tecnico_cif').addClass('border-danger');
                                $('.incorrectoCif').css('display', 'block');
                                $('.incorrectoCif').html('{% trans %}TRANS_ERROR_CIF_EXISTE{% endtrans %}');
                            }else{
                                $('#empresa_tecnico_cif').removeClass('border-danger');
                                $('#empresa_tecnico_cif').addClass('border-success');
                                $('.incorrectoCif').css('display', 'none');
                            }
                        },
                        error: function(){
                            new PNotify({
                                title: 'Ops!',
                                text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                                icon: 'icon-blocked',
                                type: 'error'
                            });
                        }
                    });
                }else{
                    $(this).removeClass('border-success');
                    $(this).addClass('border-danger');
                    $('.incorrectoCif').html('{% trans %}TRANS_ERROR_CIF{% endtrans %}');
                    $('.incorrectoCif').css('display', 'block');
                }

            });

            //Boton que genera el accidente
            $('#btnGeneraAccidente').click(function(){

                if($('#dtAccidenteLaboral').val() == ""){
                    $('#dtAccidenteLaboral').focus();
                    return false;
                }

                $('#btnGeneraAccidente').prop("disabled", true);
                $('#btnGeneraAccidente').html("<i class=\"icon-spinner2 spinner mr-2\"></i>{% trans from 'messages' %}TRANS_IMPRIMIR{% endtrans %}");

                $.ajax({
                    type: "POST",
                    url: "{{ path('gdoc_generar_file') }}",
                    data: {
                        'plantillaId': $('#plantillaAccidente').val(),
                        'id': $('#trabajadorAccidente').val(),
                        'tipo': 6,
                        'fecha': $('#dtAccidenteLaboral').val(),
                        'select2': 0
                    },
                    dataType: "JSON",
                    success: function (data) {
                        if(data != ""){

                            $('#btnGeneraAccidente').prop("disabled", false);
                            $('#btnGeneraAccidente').html("{% trans from 'messages' %}TRANS_IMPRIMIR{% endtrans %}");

                            var w = window.open();
                            w.location = data.url;

                            location.reload();
                        }
                    },
                    error: function(){
                        new PNotify({
                            title: 'Ops!',
                            text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                            icon: 'icon-blocked',
                            type: 'error'
                        });

                        $('#btnGeneraAccidente').prop("disabled", false);
                        $('#btnGeneraAccidente').html("{% trans from 'messages' %}TRANS_IMPRIMIR{% endtrans %}");
                    }
                });
            });

            //Boton para añadir un correo
            $('#btnAddCorreo').click(function(){

                if($('#email').val() == ''){
                    $('#email').focus();
                    return false;
                }

                $('#btnAddCorreo').prop("disabled", true);
                $('#btnAddCorreo').html("<i class=\"icon-spinner2 spinner mr-2\"></i>{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}");

                $.ajax({
                    type: "POST",
                    url: "{{ path('empresa_add_email') }}",
                    data: {
                        'email': $('#email').val(),
                        'funcion': $('#funcion').val(),
                        'empresaId': '{{ app.request.get('id') }}'
                    },
                    dataType: "JSON",
                    success: function (data) {

                        if(data == "OK"){

                            recuperaEmails();

                            $('#btnAddCorreo').prop("disabled", false);
                            $('#btnAddCorreo').html("{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}");

                            $('#email').val("");
                            $('#funcion').val("").change();

                            new PNotify({
                                title: '{% trans from "messages" %}TRANS_AVISO_AÑADIDO{% endtrans %}',
                                text: '{% trans from "messages" %}TRANS_AVISO_AÑADIDO_MSG{% endtrans %}',
                                icon: 'icon-checkmark3',
                                type: 'success'
                            });

                        }
                    },
                    error: function(){
                        new PNotify({
                            title: 'Ops!',
                            text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                            icon: 'icon-blocked',
                            type: 'error'
                        });

                        $('#btnAddCorreo').prop("disabled", false);
                        $('#btnAddCorreo').html("{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}");
                    }
                });
            });

            //Boton para editar el correo
            $('#btnUpdateCorreo').click(function(){

                if($('#emailEditar').val() == ''){
                    $('#emailEditar').focus();
                    return false;
                }

                $('#btnUpdateCorreo').prop("disabled", true);
                $('#btnUpdateCorreo').html("<i class=\"icon-spinner2 spinner mr-2\"></i>Guardar");

                $.ajax({
                    type: "POST",
                    url: "{{ path('empresa_update_email') }}",
                    data: {
                        'email': $('#emailEditar').val(),
                        'funcion': $('#funcionEditar').val(),
                        'correoEmpresaId': $('#correoEmpresaIdEditar').val()
                    },
                    dataType: "JSON",
                    success: function (data) {

                        if(data == "OK"){

                            recuperaEmails();

                            $('#btnUpdateCorreo').prop("disabled", false);
                            $('#btnUpdateCorreo').html("Guardar");

                            $('#emailEditar').val("");
                            $('#funcionEditar').val("").change();

                            new PNotify({
                                title: '{% trans from "messages" %}TRANS_AVISO_AÑADIDO{% endtrans %}',
                                text: '{% trans from "messages" %}TRANS_AVISO_AÑADIDO_MSG{% endtrans %}',
                                icon: 'icon-checkmark3',
                                type: 'success'
                            });

                        }
                    },
                    error: function(){
                        new PNotify({
                            title: 'Ops!',
                            text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                            icon: 'icon-blocked',
                            type: 'error'
                        });

                        $('#btnUpdateCorreo').prop("disabled", false);
                        $('#btnUpdateCorreo').html("Guardar");
                    }
                });
            });

            //Boton que genera el plan de prevencion
            $('#btnGeneraPlanPrevencion').click(function(){

                if($('#dtPlanPrevencion').val() == ""){
                    $('#dtPlanPrevencion').focus();
                    return false;
                }

                $('#btnGeneraPlanPrevencion').prop("disabled", true);
                $('#btnGeneraPlanPrevencion').html("<i class=\"icon-spinner2 spinner mr-2\"></i>{% trans from 'messages' %}TRANS_IMPRIMIR{% endtrans %}");

                $.ajax({
                    type: "POST",
                    url: "{{ path('gdoc_generar_file') }}",
                    data: {
                        'plantillaId': $('#plantillaPlanPrevencion').val(),
                        'id': '{{ app.request.get('id') }}',
                        'tipo': 8,
                        'fecha': $('#dtPlanPrevencion').val(),
                        'select2': 0
                    },
                    dataType: "JSON",
                    success: function (data) {
                        if(data != ""){

                            $('#btnGeneraPlanPrevencion').prop("disabled", false);
                            $('#btnGeneraPlanPrevencion').html("{% trans from 'messages' %}TRANS_IMPRIMIR{% endtrans %}");

                            var w = window.open();
                            w.location = data.url;

                            location.reload();
                        }
                    },
                    error: function(){
                        new PNotify({
                            title: 'Ops!',
                            text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                            icon: 'icon-blocked',
                            type: 'error'
                        });

                        $('#btnGeneraPlanPrevencion').prop("disabled", false);
                        $('#btnGeneraPlanPrevencion').html("{% trans from 'messages' %}TRANS_IMPRIMIR{% endtrans %}");
                    }
                });
            });

            //Boton que genera el protocolo de acoso
            $('#btnGeneraProtocoloAcoso').click(function(){

                if($('#dtProtocoloAcoso').val() == ""){
                    $('#dtProtocoloAcoso').focus();
                    return false;
                }

                $('#btnGeneraProtocoloAcoso').prop("disabled", true);
                $('#btnGeneraProtocoloAcoso').html("<i class=\"icon-spinner2 spinner mr-2\"></i>{% trans from 'messages' %}TRANS_IMPRIMIR{% endtrans %}");

                $.ajax({
                    type: "POST",
                    url: "{{ path('gdoc_generar_file') }}",
                    data: {
                        'plantillaId': $('#plantillaProtocoloAcoso').val(),
                        'id': '{{ app.request.get('id') }}',
                        'tipo': 19,
                        'fecha': $('#dtProtocoloAcoso').val(),
                        'select2': 0
                    },
                    dataType: "JSON",
                    success: function (data) {
                        if(data != ""){

                            $('#btnGeneraProtocoloAcoso').prop("disabled", false);
                            $('#btnGeneraProtocoloAcoso').html("{% trans from 'messages' %}TRANS_IMPRIMIR{% endtrans %}");

                            var w = window.open();
                            w.location = data.url;

                            location.reload();
                        }
                    },
                    error: function(){
                        new PNotify({
                            title: 'Ops!',
                            text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                            icon: 'icon-blocked',
                            type: 'error'
                        });

                        $('#btnGeneraProtocoloAcoso').prop("disabled", false);
                        $('#btnGeneraProtocoloAcoso').html("{% trans from 'messages' %}TRANS_IMPRIMIR{% endtrans %}");
                    }
                });
            });

            // $('.form-check-input-switch').bootstrapSwitch();

            var xhr;
            var json = {{ tree | raw }};
            var selected_id;

            function ControlViews() {
                selected_id = $("#tree").find(".jstree-clicked").attr('id');
                //Algun nodo selecionado.
                if (typeof selected_id != 'undefined' && selected_id != '') {
                    var remove = /_anchor$/;
                    selected_id = selected_id.replace(remove, "");
                    //FICHERO
                    if (selected_id.indexOf("fileId") == 0) {
                        selected_id = selected_id.replace("fileId", "");
                        plantillaAjaxRequest(selected_id);
                    }
                }
            }

            $(function () {
                $("#tree")
                    .jstree({
                        'core': {
                            'data': json,
                            'check_callback': true
                        },

                        'plugins': ["search", "sort", "state"]

                    })
                    .on('changed.jstree', function (e, data) {
                        if (xhr && xhr.readyState != 4) {
                            xhr.abort();
                        }
                        ControlViews();
                    })
                    .on('ready.jstree', function (e, data) {
                        var fileUploadedID = location.search.split('fileid=')[1];
                        //console.log(fileUploadedID);
                        if (typeof(fileUploadedID) != "undefined") {
                            var node = "fileId" + fileUploadedID;
                            $('#tree').jstree('deselect_all');
                            setTimeout(function(){
                                $('#tree').jstree('select_node', node);
                            },300);

                        }
                    });
            });

            ControlViews();

            //Evento click carpeta
            $('#tree').on("select_node.jstree", function (e, data) {
                var carpetaId = data.node['id'];
                var modificarSn = data.node['modificar'];
                if(carpetaId != "" && !isNaN(carpetaId) && modificarSn){
                    $.ajax({
                        type: 'POST',
                        url: '{{ path('gdoc_recupera_carpeta') }}',
                        data: {
                            'id': carpetaId,
                            'tipo': 3
                        },
                        dataType: 'json',
                        success: function (response) {
                            $("#idCarpeta").val(response.id);
                            $("#nombreCarpetaEditar").val(response.nombre);
                            $("#carpetaPadreEditar").val(response.padre).change();
                            $('#modal_editar_carpeta').modal('show');
                        }
                    });
                }
            });
            //Boton que edita el fichero.
            $(document).on('click', 'a.editarFichero', function(){
                var fileId = $(this).data('id');
                plantillaAjaxRequest(fileId);
            });
            function plantillaAjaxRequest(plantillaId) {

                $("#nombreFichero").val("");
                $("#fechaFichero").val("");
                $("#usuarioFichero").val("");
                $("#tipoFichero").val("");
                $("#midaFichero").val("");
                $("#idFichero").val("");
                $("#btnDownPlantilla").attr('href', "");
                $("#btnOpenPlantilla").attr('href', "");

                $('#modal_view_fichero').modal('show');

                var url = '{{ path('gdoc_plantilla_view') }}';

                $("#btnOpenPlantilla").hide();
                $("#btnDownPlantilla").hide();
                $('#btnDeletePlantilla').hide();

                var empresaId = '{{ app.request.get('id') }}';

                xhr = $.ajax({
                    type: 'POST',
                    url: url,
                    data: {
                        'id': plantillaId,
                        'tipo': 3,
                        'empresaId': '{{ app.request.get('id') }}'
                    },
                    dataType: 'json',
                    success: function (response) {
                        $("#nombreFichero").val(response.name);
                        $("#fechaFichero").val(response.fecha);
                        $("#usuarioFichero").val(response.usuario);
                        $("#tipoFichero").val(response.tipo);
                        $("#midaFichero").val(response.mida);
                        $("#idFichero").val(response.id);
                        $("#btnDownPlantilla").attr('href', '{{ path('gdoc_down_plantilla') }}?plantillaId='+response.down+'&tipo=3&empresaId='+empresaId);
                        $("#btnOpenPlantilla").attr('href', '{{ path('gdoc_open_plantilla') }}?plantillaId='+response.open+'&tipo=3&empresaId='+empresaId);
                        console.log("primera parte");
                        $("#btnDownPlantilla").show();
                        $("#btnOpenPlantilla").show();
                        $('#btnDeletePlantilla').show();
                        console.log("segunda parte");
                    }
                });
            }

            //Boton que elimina el fichero seleccionado
            $('#btnDeletePlantilla').click(function(){

                $('#btnDeletePlantilla').prop("disabled", true);
                $('#btnDeletePlantilla').html("<i class=\"icon-spinner2 spinner mr-2\"></i>{% trans from 'messages' %}TRANS_ELIMINAR{% endtrans %}");

                $.ajax({
                    type: "POST",
                    url: "{{ path('gdoc_plantilla_delete') }}",
                    data: {
                        'id': $('#idFichero').val(),
                        'tipo': 3
                    },
                    dataType: "JSON",
                    success: function (data) {

                        if(data == "OK"){

                            $('#btnDeletePlantilla').prop("disabled", false);
                            $('#btnDeletePlantilla').html("{% trans from 'messages' %}TRANS_ELIMINAR{% endtrans %}");

                            new PNotify({
                                title: '{% trans from "messages" %}TRANS_AVISO_ELIMINADO{% endtrans %}',
                                text: '{% trans from "messages" %}TRANS_AVISO_ELIMINADO_MSG{% endtrans %}',
                                icon: 'icon-checkmark3',
                                type: 'success'
                            });

                            setTimeout(function() {
                                location.reload();
                            }, 2000);

                        }
                    },
                    error: function(){
                        new PNotify({
                            title: 'Ops!',
                            text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                            icon: 'icon-blocked',
                            type: 'error'
                        });

                        $('#btnDeletePlantilla').prop("disabled", false);
                        $('#btnDeletePlantilla').html("{% trans from 'messages' %}TRANS_ELIMINAR{% endtrans %}");
                    }
                });

            });

            //Botón que añade la nueva carpeta
            $('#btnAddCarpeta').click(function(){

                var nombreCarpeta = $('#nombreCarpeta').val();
                var carpetaPadre = $('#carpetaPadre').val();

                if(nombreCarpeta == "" || nombreCarpeta == null){
                    $('#nombreCarpeta').focus();
                    return false;
                }

                $('#btnAddCarpeta').prop("disabled", true);
                $('#btnAddCarpeta').html("<i class=\"icon-spinner2 spinner mr-2\"></i>{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}");

                $.ajax({
                    type: "POST",
                    url: "{{ path('gdoc_carpeta_add') }}",
                    data: {
                        'nombre': nombreCarpeta,
                        'padre': carpetaPadre,
                        'tipo': 3,
                        'empresaId': '{{ app.request.get('id') }}'
                    },
                    dataType: "JSON",
                    success: function (data) {
                        if(data == "OK"){
                            location.reload();
                        }
                    },
                    error: function(){
                        new PNotify({
                            title: 'Ops!',
                            text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                            icon: 'icon-blocked',
                            type: 'error'
                        });

                        $('#btnAddCarpeta').prop("disabled", false);
                        $('#btnAddCarpeta').html("{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}");
                    }
                });
            });

            //Botón que modifica la carpeta seleccionada
            $('#btnUpdateCarpeta').click(function(){

                var nombreCarpeta = $('#nombreCarpetaEditar').val();
                var carpetaPadre = $('#carpetaPadreEditar').val();
                var id = $('#idCarpeta').val();

                if(nombreCarpeta == "" || nombreCarpeta == null){
                    $('#nombreCarpetaEditar').focus();
                    return false;
                }

                $('#btnUpdateCarpeta').prop("disabled", true);
                $('#btnUpdateCarpeta').html("<i class=\"icon-spinner2 spinner mr-2\"></i>Guardar");

                $.ajax({
                    type: "POST",
                    url: "{{ path('gdoc_carpeta_update') }}",
                    data: {
                        'id': id,
                        'nombre': nombreCarpeta,
                        'padre': carpetaPadre,
                        'tipo': 3,
                    },
                    dataType: "JSON",
                    success: function (data) {
                        if(data == "OK"){
                            location.reload();
                        }
                    },
                    error: function(){
                        new PNotify({
                            title: 'Ops!',
                            text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                            icon: 'icon-blocked',
                            type: 'error'
                        });

                        $('#btnUpdateCarpeta').prop("disabled", false);
                        $('#btnUpdateCarpeta').html("Guardar");
                    }
                });
            });

            //Botón que modifica la carpeta seleccionada
            $('#btnDeleteCarpeta').click(function(){

                var id = $('#idCarpeta').val();

                $('#btnDeleteCarpeta').prop("disabled", true);
                $('#btnDeleteCarpeta').html("<i class=\"icon-spinner2 spinner mr-2\"></i>Eliminar");

                $.ajax({
                    type: "POST",
                    url: "{{ path('gdoc_carpeta_delete') }}",
                    data: {
                        'id': id,
                        'tipo': 3
                    },
                    dataType: "JSON",
                    success: function (data) {
                        if(data == "OK"){
                            location.reload();
                        }
                    },
                    error: function(){
                        new PNotify({
                            title: 'Ops!',
                            text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                            icon: 'icon-blocked',
                            type: 'error'
                        });

                        $('#btnUpdateCarpeta').prop("disabled", false);
                        $('#btnUpdateCarpeta').html("Guardar");
                    }
                });
            });

            //Evento que busca la localidad y provincia
            $('#empresa_tecnico_codigoPostalPostal').focusout(function(){
                $.ajax({
                    type: "POST",
                    url: "{{ path('empresa_busca_localidad_provincia') }}",
                    data: {
                        'codigopostal': $('#empresa_tecnico_codigoPostalPostal').val(),
                    },
                    dataType: "JSON",
                    success: function (data) {
                        console.log(data);
                        if(data != ""){
                            $('#empresa_tecnico_localidadPostal').val(data.localidad);
                            $('#empresa_tecnico_provinciaPostal').val(data.provincia);
                            $('#empresa_tecnico_provinciaPostalSerpa').val(data.provincia_id).change();
                            $('#empresa_tecnico_municipioPostalSerpa').val(data.localidad_id).change();
                        }
                    },
                    error: function(){
                        new PNotify({
                            title: 'Ops!',
                            text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                            icon: 'icon-blocked',
                            type: 'error'
                        });
                    }
                });
            });

            var xhrPuestos;
            var jsonPuestos = {{ treePuestos | raw }};
            var selected_idPuestos;

            function ControlViewsPuestos() {
                selected_idPuestos = $("#treePuestos").find(".jstree-clicked").attr('id');
                //Algun nodo selecionado.
                if (typeof selected_idPuestos != 'undefined' && selected_idPuestos != '') {
                    var remove = /_anchor$/;
                    selected_idPuestos = selected_idPuestos.replace(remove, "");

                    //Puesto de trabajo seleccionado
                    if (selected_idPuestos.indexOf("puestoTrabajoId") == 0) {
                        selected_idPuestos = selected_idPuestos.replace("puestoTrabajoId", "");
                        puestoTrabajoAjaxRequest(selected_idPuestos);
                    }
                }
            }

            $(function () {
                $("#treePuestos")
                    .jstree({
                        'core': {
                            'data': jsonPuestos,
                            'check_callback': true
                        },
                        'plugins': ["search", "sort", "state"]
                    })
                    .on('changed.jstree', function (e, data) {
                        if (xhrPuestos && xhrPuestos.readyState != 4) {
                            xhrPuestos.abort();
                        }

                        ControlViewsPuestos();
                    })
                    .on('ready.jstree', function (e, data) {
                        var fileUploadedID = location.search.split('fileid=')[1];
                        //console.log(fileUploadedID);
                        if (typeof(fileUploadedID) != "undefined") {
                            var node = "fileId" + fileUploadedID;
                            $('#treePuestos').jstree('deselect_all');
                            setTimeout(function(){
                                $('#treePuestos').jstree('select_node', node);
                            },300);

                        }
                    });
            });

            //Evento click zona trabajo
            $('#treePuestos').on("select_node.jstree", function (e, data) {
                var zonaId = data.node['id'];

                if(zonaId != "" && !isNaN(zonaId)){
                    $("#zonaIdEdit").val('');
                    $("#nombreZonaEdit").val('');
                    $.ajax({
                        type: 'POST',
                        url: '{{ path('tecnico_puesto_trabajo_recuperate_zona_trabajo') }}',
                        data: {
                            'zonaId': zonaId,
                        },
                        dataType: 'json',
                        success: function (response) {
                            $("#zonaIdEdit").val(response.id);
                            $("#nombreZonaEdit").val(response.descripcion);
                            $('#modal_editar_zona').modal('show');
                        }
                    });
                }
            });

            function puestoTrabajoAjaxRequest(puestoTrabajoId){
                $("#nombrePuestoEdit").val('');
                $("#observacionesEdit").val('');
                $("#codigoEdit").val('');
                $("#zonaTrabajoEdit").val('');
                $("#puestoTrabajoIdEdit").val('');

                var url = '{{ path('tecnico_puesto_trabajo_recuperate_puesto_trabajo') }}';
                // Desseleccionar todos los nodos
                $('#treePuestos').jstree('deselect_all');
                $('#modal_editar_puesto_trabajo').modal('show');

                xhr = $.ajax({
                    type: 'POST',
                    url: url,
                    data: {
                        'puestoTrabajoId': puestoTrabajoId,
                    },
                    dataType: 'json',
                    success: function (response) {
                        $("#nombrePuestoEdit").val(response.descripcion);
                        $("#observacionesEdit").val(response.observaciones);
                        $("#codigoEdit").val(response.codigo);
                        $("#zonaTrabajoEdit").val(response.zonaId).change();
                        $("#puestoTrabajoIdEdit").val(response.id);
                        $('#puestoGenericoEdit').val(response.puestoTrabajoGenericoId).change();
                    },
                    error: function(){
                        new PNotify({
                            title: 'Ops!',
                            text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                            icon: 'icon-blocked',
                            type: 'error'
                        });
                    }
                });
            }

            //Boton que añade la zona de trabajo
            $('#btnAddZonaTrabajo').click(function () {

                if($('#nombreZona').val() == ''){
                    $('#nombreZona').focus();
                    return false;
                }

                $('#btnAddZonaTrabajo').prop("disabled", true);
                $('#btnAddZonaTrabajo').html("<i class=\"icon-spinner2 spinner mr-2\"></i>{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}");

                $.ajax({
                    type: "POST",
                    url: "{{ path('tecnico_puesto_trabajo_create_zona_trabajo') }}",
                    data: {
                        'descripcion': $('#nombreZona').val(),
                        'empresaId': '{{ app.request.get('id') }}'
                    },
                    dataType: "JSON",
                    success: function (data) {
                        if(data == "OK"){
                            location.reload();
                        }
                    },
                    error: function(){
                        new PNotify({
                            title: 'Ops!',
                            text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                            icon: 'icon-blocked',
                            type: 'error'
                        });

                        $('#btnAddZonaTrabajo').prop("disabled", false);
                        $('#btnAddZonaTrabajo').html("{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}<b><i class=\"icon-plus3\"></i></b>");
                    }
                });
            });

            //Boton que modifica la zona de trabajo
            $('#btnUpdateZonaTrabajo').click(function () {

                if($('#nombreZonaEdit').val() == ''){
                    $('#nombreZonaEdit').focus();
                    return false;
                }

                $('#btnUpdateZonaTrabajo').prop("disabled", true);
                $('#btnUpdateZonaTrabajo').html("<i class=\"icon-spinner2 spinner mr-2\"></i>Guardar");

                $.ajax({
                    type: "POST",
                    url: "{{ path('tecnico_puesto_trabajo_update_zona_trabajo') }}",
                    data: {
                        'descripcion': $('#nombreZonaEdit').val(),
                        'zonaId': $('#zonaIdEdit').val()
                    },
                    dataType: "JSON",
                    success: function (data) {
                        if(data == "OK"){
                            location.reload();
                        }
                    },
                    error: function(){
                        new PNotify({
                            title: 'Ops!',
                            text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                            icon: 'icon-blocked',
                            type: 'error'
                        });

                        $('#btnUpdateZonaTrabajo').prop("disabled", false);
                        $('#btnUpdateZonaTrabajo').html("Guardar");
                    }
                });
            });

            //Boton que elimina la zona de trabajo
            $('#btnDeleteZonaTrabajo').click(function () {

                $('#btnDeleteZonaTrabajo').prop("disabled", true);
                $('#btnDeleteZonaTrabajo').html("<i class=\"icon-spinner2 spinner mr-2\"></i>Eliminar");

                $.ajax({
                    type: "POST",
                    url: "{{ path('tecnico_puesto_trabajo_delete_zona_trabajo') }}",
                    data: {
                        'zonaId': $('#zonaIdEdit').val(),
                    },
                    dataType: "JSON",
                    success: function (data) {
                        if(data == "OK"){
                            location.reload();
                        }
                    },
                    error: function(){
                        new PNotify({
                            title: 'Ops!',
                            text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                            icon: 'icon-blocked',
                            type: 'error'
                        });

                        $('#btnDeleteZonaTrabajo').prop("disabled", false);
                        $('#btnDeleteZonaTrabajo').html("Guardar");
                    }
                });

            });

            //Boton que añade el puesto de trabajo
            $('#btnAddPuestoTrabajo').click(function () {

                if($('#nombrePuesto').val() == ''){
                    $('#nombrePuesto').focus();
                    return false;
                }

                /*if($('#zonaTrabajo').val() == ''){
                    $('#zonaTrabajo').focus();
                    return false;
                }*/

                $('#btnAddPuestoTrabajo').prop("disabled", true);
                $('#btnAddPuestoTrabajo').html("<i class=\"icon-spinner2 spinner mr-2\"></i>{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}");

                $.ajax({
                    type: "POST",
                    url: "{{ path('tecnico_puesto_trabajo_create_puesto_trabajo') }}",
                    data: {
                        'nombre': $('#nombrePuesto').val(),
                        'codigo': $('#codigo').val(),
                        'observaciones': $('#observaciones').val(),
                        'zonaId': $('#zonaTrabajo').val(),
                        'empresaId': '{{ app.request.get('id') }}',
                        'tipo': 1,
                        'puestoTrabajoGenerico': $('#puestoGenerico').val()
                    },
                    dataType: "JSON",
                    success: function (data) {
                        if(data == "OK"){
                            location.reload();
                        }
                    },
                    error: function(){
                        new PNotify({
                            title: 'Ops!',
                            text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                            icon: 'icon-blocked',
                            type: 'error'
                        });

                        $('#btnAddPuestoTrabajo').prop("disabled", false);
                        $('#btnAddPuestoTrabajo').html("{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}");
                    }
                });
            });

            //Boton que modifica el puesto de trabajo
            $('#btnUpdatePuestoTrabajo').click(function () {

                if($('#nombrePuestoEdit').val() == ''){
                    $('#nombrePuestoEdit').focus();
                    return false;
                }

                /*if($('#zonaTrabajoEdit').val() == ''){
                    $('#zonaTrabajoEdit').focus();
                    return false;
                }*/

                $('#btnUpdatePuestoTrabajo').prop("disabled", true);
                $('#btnUpdatePuestoTrabajo').html("<i class=\"icon-spinner2 spinner mr-2\"></i>Guardar");

                $.ajax({
                    type: "POST",
                    url: "{{ path('tecnico_puesto_trabajo_update_puesto_trabajo') }}",
                    data: {
                        'descripcion': $('#nombrePuestoEdit').val(),
                        'codigo': $('#codigoEdit').val(),
                        'observaciones': $('#observacionesEdit').val(),
                        'zonaId': $('#zonaTrabajoEdit').val(),
                        'puestoTrabajoId': $('#puestoTrabajoIdEdit').val(),
                        'puestoTrabajoGenerico': $('#puestoGenericoEdit').val()
                    },
                    dataType: "JSON",
                    success: function (data) {
                        if(data == "OK"){
                            location.reload();
                        }
                    },
                    error: function(){
                        new PNotify({
                            title: 'Ops!',
                            text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                            icon: 'icon-blocked',
                            type: 'error'
                        });

                        $('#btnUpdatePuestoTrabajo').prop("disabled", false);
                        $('#btnUpdatePuestoTrabajo').html("Guardar");
                    }
                });
            });

            //Boton que elimina el puesto de trabajo
            $('#btnDeletePuestoTrabajo').click(function () {

                $('#btnDeletePuestoTrabajo').prop("disabled", true);
                $('#btnDeletePuestoTrabajo').html("<i class=\"icon-spinner2 spinner mr-2\"></i>Eliminar");

                $.ajax({
                    type: "POST",
                    url: "{{ path('tecnico_puesto_trabajo_delete_puesto_trabajo') }}",
                    data: {
                        'puestoTrabajoId': $('#puestoTrabajoIdEdit').val(),
                    },
                    dataType: "JSON",
                    success: function (data) {
                        if(data == "OK"){
                            location.reload();
                        }
                    },
                    error: function(){
                        new PNotify({
                            title: 'Ops!',
                            text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                            icon: 'icon-blocked',
                            type: 'error'
                        });

                        $('#btnUpdatePuestoTrabajo').prop("disabled", false);
                        $('#btnUpdatePuestoTrabajo').html("Guardar");
                    }
                });
            });

            //Boton que añade la maquina generica al puesto de trabajo
            $('#btnAddMaquinaGenericaPuestoTrabajo').click(function () {

                $('#btnAddMaquinaGenericaPuestoTrabajo').prop("disabled", true);
                $('#btnAddMaquinaGenericaPuestoTrabajo').html("<i class=\"icon-spinner2 spinner mr-2\"></i>{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}");

                $.ajax({
                    type: "POST",
                    url: "{{ path('tecnico_puesto_trabajo_add_maquina_generica') }}",
                    data: {
                        'puestoTrabajoId': $('#puestoTrabajoMaquinaGenerica').val(),
                        'maquinaGenericaId': $('#maquinaGenericaPuestoTrabajo').val(),
                        'empresaId': '{{ app.request.get('id') }}',
                        'tipo': 1
                    },
                    dataType: "JSON",
                    success: function (data) {
                        if(data == "OK"){
                            location.reload();
                        }
                    },
                    error: function(){
                        new PNotify({
                            title: 'Ops!',
                            text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                            icon: 'icon-blocked',
                            type: 'error'
                        });

                        $('#btnAddMaquinaGenericaPuestoTrabajo').prop("disabled", false);
                        $('#btnAddMaquinaGenericaPuestoTrabajo').html("{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}");
                    }
                });
            });

            //Boton que añade la maquina generica a la zona de trabajo
            $('#btnAddMaquinaGenericaZonaTrabajo').click(function () {

                $('#btnAddMaquinaGenericaZonaTrabajo').prop("disabled", true);
                $('#btnAddMaquinaGenericaZonaTrabajo').html("<i class=\"icon-spinner2 spinner mr-2\"></i>{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}");

                $.ajax({
                    type: "POST",
                    url: "{{ path('tecnico_puesto_trabajo_add_maquina_generica') }}",
                    data: {
                        'zonaTrabajoId': $('#zonaTrabajoMaquinaGenerica').val(),
                        'maquinaGenericaId': $('#maquinaGenericaZonaTrabajo').val(),
                        'empresaId': '{{ app.request.get('id') }}',
                        'tipo': 2
                    },
                    dataType: "JSON",
                    success: function (data) {
                        if(data == "OK"){
                            location.reload();
                        }
                    },
                    error: function(){
                        new PNotify({
                            title: 'Ops!',
                            text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                            icon: 'icon-blocked',
                            type: 'error'
                        });

                        $('#btnAddMaquinaGenericaZonaTrabajo').prop("disabled", false);
                        $('#btnAddMaquinaGenericaZonaTrabajo').html("{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}");
                    }
                });
            });

            //Boton que añade la maquina empresa al puesto de trabajo
            $('#btnAddMaquinaEmpresaPuestoTrabajo').click(function () {

                $('#btnAddMaquinaEmpresaPuestoTrabajo').prop("disabled", true);
                $('#btnAddMaquinaEmpresaPuestoTrabajo').html("<i class=\"icon-spinner2 spinner mr-2\"></i>{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}");

                $.ajax({
                    type: "POST",
                    url: "{{ path('tecnico_puesto_trabajo_add_maquina_generica') }}",
                    data: {
                        'puestoTrabajoId': $('#puestoTrabajoMaquinaEmpresa').val(),
                        'maquinaEmpresaId': $('#maquinaEmpresaPuestoTrabajo').val(),
                        'empresaId': '{{ app.request.get('id') }}',
                        'tipo': 3
                    },
                    dataType: "JSON",
                    success: function (data) {
                        if(data == "OK"){
                            location.reload();
                        }
                    },
                    error: function(){
                        new PNotify({
                            title: 'Ops!',
                            text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                            icon: 'icon-blocked',
                            type: 'error'
                        });

                        $('#btnAddMaquinaEmpresaPuestoTrabajo').prop("disabled", false);
                        $('#btnAddMaquinaEmpresaPuestoTrabajo').html("{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}");
                    }
                });
            });

            //Boton que añade la maquina empresa a la zona de trabajo
            $('#btnAddMaquinaEmpresaZonaTrabajo').click(function () {

                $('#btnAddMaquinaEmpresaZonaTrabajo').prop("disabled", true);
                $('#btnAddMaquinaEmpresaZonaTrabajo').html("<i class=\"icon-spinner2 spinner mr-2\"></i>{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}");

                $.ajax({
                    type: "POST",
                    url: "{{ path('tecnico_puesto_trabajo_add_maquina_generica') }}",
                    data: {
                        'zonaTrabajoId': $('#zonaTrabajoMaquinaEmpresa').val(),
                        'maquinaEmpresaId': $('#maquinaEmpresaZonaTrabajo').val(),
                        'empresaId': '{{ app.request.get('id') }}',
                        'tipo': 4
                    },
                    dataType: "JSON",
                    success: function (data) {
                        if(data == "OK"){
                            location.reload();
                        }
                    },
                    error: function(){
                        new PNotify({
                            title: 'Ops!',
                            text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                            icon: 'icon-blocked',
                            type: 'error'
                        });

                        $('#btnAddMaquinaEmpresaZonaTrabajo').prop("disabled", false);
                        $('#btnAddMaquinaEmpresaZonaTrabajo').html("{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}");
                    }
                });
            });

            //Evento cuando cambian el puesto de trabajo generico
            $('#puestoGenerico').change(function () {
                var val = $( "#puestoGenerico option:selected" ).text();
                if(val != ""){
                    $('#nombrePuesto').val(val);
                }
            });

            $('#btnAddEvaluacion').click(function () {
                var tipo = $('input:radio[name=tipoEvaluacion]:checked').val();

                if(tipo == undefined){
                    $('input:radio[name=edad]').focus();
                    return false;
                }

                $('#btnAddEvaluacion').prop("disabled", true);
                $('#btnAddEvaluacion').html("<i class=\"icon-spinner2 spinner mr-2\"></i>{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}");

                $.ajax({
                    type: "POST",
                    url: "{{ path('tecnico_evaluaciones_evaluacion_pre_create') }}",
                    data: {
                        'empresaId': '{{ app.request.get('id') }}',
                        'tipo': tipo
                    },
                    dataType: "JSON",
                    success: function (data) {
                        if(data == "OK"){
                            location.href = '{{ path('tecnico_evaluaciones_evaluacion_create') }}?tipo='+tipo;
                        }
                    },
                    error: function(){
                        new PNotify({
                            title: 'Ops!',
                            text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                            icon: 'icon-blocked',
                            type: 'error'
                        });

                        $('#btnAddEvaluacion').prop("disabled", false);
                        $('#btnAddEvaluacion').html("{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}");
                    }
                });
            });

            $('a[data-toggle="tab"]').on('show.bs.tab', function(e) {
                localStorage.setItem('activeTabEmpresaTecnico', $(e.target).attr('href'));
            });
            var activeTab = localStorage.getItem('activeTabEmpresaTecnico');
            if(activeTab){
                $('#tabs a[href="' + activeTab + '"]').tab('show');
            }
        });

        function recuperaCnaes(){
            $.ajax({
                type: "POST",
                url: "{{ path('empresa_recupera_cnaes') }}",
                data: {
                    'empresaId': '{{ app.request.get('id') }}'
                },
                dataType: "JSON",
                beforeSend: function(data){
                    $("#cnae").block({
                        message: '<i class="icon-spinner2 spinner"></i>',
                        overlayCSS: {
                            backgroundColor: '#fff',
                            opacity: 0.8,
                            cursor: 'wait'
                        },
                        css: {
                            border: 0,
                            padding: 0,
                            backgroundColor: 'none'
                        }
                    });
                },
                success: function (data) {

                    var table = '<thead><tr class="bg-grey-300"><th>{% trans from 'empresas' %}TRANS_PRINCIPAL_CNAE{% endtrans %}</th><th>{% trans from 'empresas' %}TRANS_CODIGO_CNAE{% endtrans %}</th><th>{% trans from 'empresas' %}TRANS_DESCRIPCION_CNAE{% endtrans %}</th><th>{% trans from 'messages' %}TRANS_ACCIONES{% endtrans %}</th></tr></thead>';

                    table += "<tbody>";

                    if(JSON.parse(data) != ""){
                        var item = 1;

                        $.each(JSON.parse(data), function (key, item) {

                            if (item % 2 == 0) {
                                table += '<tr class="grid-row-cells odd"> ';
                            }
                            else {
                                table += '<tr  class="grid-row-cells even"> ';
                            }

                            if (item["principal"] != undefined) {
                                if(item["principal"] == true){
                                    table += '<td><span class="badge badge-flat border-success text-success-600"><i class="icon-checkmark2"></i></span></td>';
                                }else{
                                    table += '<td><span class="badge badge-flat border-danger text-danger-600"><i class="icon-cross3"></i></span></td>';
                                }
                            }
                            else {
                                table += '<td></td>';
                            }

                            if (item["cnae"] != undefined) {
                                table += '<td>' + item["cnae"]+ '</td>';
                            }
                            else {
                                table += '<td></td>';
                            }

                            if (item["descripcion"] != undefined) {
                                table += '<td>' + item["descripcion"]+ '</td>';
                            }
                            else {
                                table += '<td></td>';
                            }

                            if (item["id"] != undefined) {
                                table += '<td><div class="list-icons">';

                                {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn is defined and app.session.get('privilegiosRol').editEmpresaTecnicoSn is not null %}
                                {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn and impagadaSn is defined and impagadaSn == false %}
                                table += '<a href="#" data-id="' + item["id"]+ '" target="_self" class="list-icons-item" onclick="recuperaCnae('+ item["id"]+');" data-toggle="modal" data-target="#modal_editar_cnae"><i class="icon-pencil7"></i></a>';
                                table += '<a href="#" data-id="' + item["id"]+ '" target="_self" class="list-icons-item eliminarCnae"><i class="icon-trash"></i></a>';
                                {% endif %}
                                {% endif %}

                                table += '</div></td>';
                            }
                            else {
                                table += '<td></td>';
                            }

                            item++;

                            table += '</tr>';

                        });

                    }else{
                        table += "<tr><td colspan='2' align='center'>{% trans from 'messages' %}TRANS_SIN_REGISTROS{% endtrans %}</td></tr>";
                    }

                    table += "</tbody>";

                    $("#cnae").html("");
                    $("#cnae").html(table);

                },
                error: function(){
                    new PNotify({
                        title: 'Ops!',
                        text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                        icon: 'icon-blocked',
                        type: 'error'
                    });
                }
            });
        }

        function recuperaCentroTrabajo(){
            $.ajax({
                type: "POST",
                url: "{{ path('empresa_recupera_centro_trabajo_empresa') }}",
                data: {
                    'empresaId': '{{ app.request.get('id') }}'
                },
                dataType: "JSON",
                beforeSend: function(data){
                    $("#centroTrabajoEmpresa").block({
                        message: '<i class="icon-spinner2 spinner"></i>',
                        overlayCSS: {
                            backgroundColor: '#fff',
                            opacity: 0.8,
                            cursor: 'wait'
                        },
                        css: {
                            border: 0,
                            padding: 0,
                            backgroundColor: 'none'
                        }
                    });
                },
                success: function (data) {

                    var table = '<thead><tr class="bg-grey-300"><th>{% trans from 'empresas' %}TRANS_NOMBRE{% endtrans %}</th><th>{% trans from 'messages' %}TRANS_ACCIONES{% endtrans %}</th></tr></thead>';

                    table += '<tbody>';

                    if(JSON.parse(data) != ""){
                        var item = 1;

                        $.each(JSON.parse(data), function (key, item) {

                            if (item % 2 == 0) {
                                table += '<tr class="grid-row-cells odd"> ';
                            }
                            else {
                                table += '<tr  class="grid-row-cells even"> ';
                            }

                            if (item["direccion"] != undefined) {
                                table += '<td>' + item["direccion"]+ '</td>';
                            }
                            else {
                                table += '<td></td>';
                            }

                            if (item["id"] != undefined) {
                                table += '<td><div class="list-icons">';

                                {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn is defined and app.session.get('privilegiosRol').editEmpresaTecnicoSn is not null %}
                                {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn and impagadaSn is defined and impagadaSn == false %}
                                table += '<a href="#" data-id="' + item["id"]+ '" target="_self" class="list-icons-item eliminarCentroTrabajo"><i class="icon-trash"></i></a>';
                                {% endif %}
                                {% endif %}

                                table += '</div></td>';
                            }
                            else {
                                table += '<td></td>';
                            }

                            item++;

                            table += '</tr>';
                        });

                    }else{
                        table += "<tr><td colspan='2' align='center'>{% trans from 'messages' %}TRANS_SIN_REGISTROS{% endtrans %}</td></tr>";
                    }

                    table += "</tbody>";

                    $("#centroTrabajoEmpresa").html("");
                    $("#centroTrabajoEmpresa").html(table);

                },
                error: function(){
                    new PNotify({
                        title: 'Ops!',
                        text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                        icon: 'icon-blocked',
                        type: 'error'
                    });
                }
            });
        }

        function recuperaCnae(id) {
            $.ajax({
                type: "POST",
                url: "{{ path('empresa_recupera_cnae') }}",
                data: {
                    'cnaeEmpresaId': id
                },
                dataType: "JSON",
                success: function (data) {
                    if (data != null) {
                        $('#cnaeValorEditar').val(data.cnaeId).change();
                        $('#cnaeEmpresaIdEditar').val(data.id);

                        if(data.principal == true){
                            $('#uniform-principalEditar span').addClass('checked');
                            $('#principalEditar').attr("checked", "checked");
                        }else{
                            $('#uniform-principalEditar span').removeClass('checked');
                        }

                    }
                },
                error: function () {
                    new PNotify({
                        title: 'Ops!',
                        text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                        icon: 'icon-blocked',
                        type: 'error'
                    });
                }
            });
        }

        function deleteCnae(id) {
            $.ajax({
                type: "POST",
                url: "{{ path('empresa_delete_cnae') }}",
                data: {
                    'cnaeEmpresaId': id
                },
                dataType: "JSON",
                success: function (data) {
                    if (data == "OK") {

                        recuperaCnaes();

                        new PNotify({
                            title: '{% trans from "messages" %}TRANS_AVISO_ELIMINADO{% endtrans %}',
                            text: '{% trans from "messages" %}TRANS_AVISO_ELIMINADO_MSG{% endtrans %}',
                            icon: 'icon-checkmark3',
                            type: 'success'
                        });
                    }
                },
                error: function () {
                    new PNotify({
                        title: 'Ops!',
                        text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                        icon: 'icon-blocked',
                        type: 'error'
                    });
                }
            });
        }

        function deleteTrabajadorEmpresa(id) {
            $.ajax({
                type: "POST",
                url: "{{ path('empresa_delete_trabajador_empresa') }}",
                data: {
                    'trabajadorEmpresaId': id
                },
                dataType: "JSON",
                success: function (data) {
                    if (data == "OK") {
                        location.reload();
                    }
                },
                error: function () {
                    new PNotify({
                        title: 'Ops!',
                        text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                        icon: 'icon-blocked',
                        type: 'error'
                    });
                }
            });
        }

        function deleteCentroTrabajo(id) {
            $.ajax({
                type: "POST",
                url: "{{ path('empresa_delete_centro_trabajo_empresa') }}",
                data: {
                    'centroEmpresaId': id
                },
                dataType: "JSON",
                success: function (data) {
                    if (data == "OK") {
                        recuperaCentroTrabajo();

                        new PNotify({
                            title: '{% trans from "messages" %}TRANS_AVISO_ELIMINADO{% endtrans %}',
                            text: '{% trans from "messages" %}TRANS_AVISO_ELIMINADO_MSG{% endtrans %}',
                            icon: 'icon-checkmark3',
                            type: 'success'
                        });
                    }
                },
                error: function () {
                    new PNotify({
                        title: 'Ops!',
                        text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                        icon: 'icon-blocked',
                        type: 'error'
                    });
                }
            });
        }

        $(document).on('click', 'a.eliminarCnae', function(){
            var id = $(this).data('id');

            bootbox.confirm({
                title: '{% trans from 'messages' %}TRANS_ELIMINAR_CNAE{% endtrans %}',
                message: '{% trans from 'messages' %}TRANS_CONFIRM_DELETE_REGISTRO{% endtrans %}',
                buttons: {
                    confirm: {
                        label: 'Si',
                        className: 'btn-primary'
                    },
                    cancel: {
                        label: 'No',
                        className: 'btn-link'
                    }
                },
                callback: function (result) {
                    if(result == true){
                        deleteCnae(id)
                    }
                }
            });
        });

        $(document).on('click', 'a.eliminarTrabajador', function(){
            var id = $(this).data('id');

            bootbox.confirm({
                title: '{% trans from 'messages' %}TRANS_ELIMINAR_TRABAJADOR{% endtrans %}',
                message: '{% trans from 'messages' %}TRANS_CONFIRM_DELETE_REGISTRO{% endtrans %}',
                buttons: {
                    confirm: {
                        label: 'Si',
                        className: 'btn-primary'
                    },
                    cancel: {
                        label: 'No',
                        className: 'btn-link'
                    }
                },
                callback: function (result) {
                    if(result == true){
                        deleteTrabajadorEmpresa(id)
                    }
                }
            });
        });

        $(document).on('click', 'a.eliminarCentroTrabajo', function(){
            var id = $(this).data('id');

            bootbox.confirm({
                title: '{% trans from 'messages' %}TRANS_ELIMINAR_CENTRO{% endtrans %}',
                message: '{% trans from 'messages' %}TRANS_CONFIRM_DELETE_REGISTRO{% endtrans %}',
                buttons: {
                    confirm: {
                        label: 'Si',
                        className: 'btn-primary'
                    },
                    cancel: {
                        label: 'No',
                        className: 'btn-link'
                    }
                },
                callback: function (result) {
                    if(result == true){
                        deleteCentroTrabajo(id)
                    }
                }
            });
        });

        function deleteFichero(id, tipo) {
            $.ajax({
                type: "POST",
                url: "{{ path('gdoc_delete_file') }}",
                data: {
                    'id': id,
                    'tipo': tipo
                },
                dataType: "JSON",
                success: function (data) {
                    if (data == "OK") {
                        location.reload();
                    }
                },
                error: function () {
                    new PNotify({
                        title: 'Ops!',
                        text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                        icon: 'icon-blocked',
                        type: 'error'
                    });
                }
            });
        }

        //Boton que elimina el fichero seleccionado
        $(document).on('click', 'a.eliminarFicheroAccidente', function(){
            var fileId = $(this).data('id');
            bootbox.confirm({
                title: '{% trans from 'messages' %}TRANS_ELIMINAR_FICHERO{% endtrans %}',
                message: '{% trans from 'messages' %}TRANS_CONFIRM_DELETE_REGISTRO{% endtrans %}',
                buttons: {
                    confirm: {
                        label: 'Si',
                        className: 'btn-primary'
                    },
                    cancel: {
                        label: 'No',
                        className: 'btn-link'
                    }
                },
                callback: function (result) {
                    if(result == true){
                        deleteFichero(fileId,6)
                    }
                }
            });
        });

        $(document).on('click', 'a.eliminarFicheroPlanPrevencion', function(){
            var fileId = $(this).data('id');
            bootbox.confirm({
                title: '{% trans from 'messages' %}TRANS_ELIMINAR_FICHERO{% endtrans %}',
                message: '{% trans from 'messages' %}TRANS_CONFIRM_DELETE_REGISTRO{% endtrans %}',
                buttons: {
                    confirm: {
                        label: 'Si',
                        className: 'btn-primary'
                    },
                    cancel: {
                        label: 'No',
                        className: 'btn-link'
                    }
                },
                callback: function (result) {
                    if(result == true){
                        deleteFichero(fileId,8)
                    }
                }
            });
        });

        $(document).on('click', 'a.eliminarFicheroProtocoloAcoso', function(){
            var fileId = $(this).data('id');
            bootbox.confirm({
                title: '{% trans from 'messages' %}TRANS_ELIMINAR_FICHERO{% endtrans %}',
                message: '{% trans from 'messages' %}TRANS_CONFIRM_DELETE_REGISTRO{% endtrans %}',
                buttons: {
                    confirm: {
                        label: 'Si',
                        className: 'btn-primary'
                    },
                    cancel: {
                        label: 'No',
                        className: 'btn-link'
                    }
                },
                callback: function (result) {
                    if(result == true){
                        deleteFichero(fileId,19)
                    }
                }
            });
        });

        function isValidCif(cif) {
            if (!cif || cif.length !== 9) {
                return false;
            }

            var letters = ['J', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I'];
            var digits = cif.substr(1, cif.length - 2);
            var letter = cif.substr(0, 1);
            var control = cif.substr(cif.length - 1);
            var sum = 0;
            var i;
            var digit;

            if (!letter.match(/[A-Z]/)) {
                return false;
            }

            for (i = 0; i < digits.length; ++i) {
                digit = parseInt(digits[i]);

                if (isNaN(digit)) {
                    return false;
                }

                if (i % 2 === 0) {
                    digit *= 2;
                    if (digit > 9) {
                        digit = parseInt(digit / 10) + (digit % 10);
                    }

                    sum += digit;
                } else {
                    sum += digit;
                }
            }

            sum %= 10;
            if (sum !== 0) {
                digit = 10 - sum;
            } else {
                digit = sum;
            }

            if (letter.match(/[ABEH]/)) {
                return String(digit) === control;
            }
            if (letter.match(/[NPQRSW]/)) {
                return letters[digit] === control;
            }

            return String(digit) === control || letters[digit] === control;
        }

        function recuperaTecnicos(){
            $.ajax({
                type: "POST",
                url: "{{ path('empresa_recupera_tecnicos') }}",
                data: {
                    'empresaId': '{{ app.request.get('id') }}'
                },
                dataType: "JSON",
                beforeSend: function(data){
                    $("#tecnicos").block({
                        message: '<i class="icon-spinner2 spinner"></i>',
                        overlayCSS: {
                            backgroundColor: '#fff',
                            opacity: 0.8,
                            cursor: 'wait'
                        },
                        css: {
                            border: 0,
                            padding: 0,
                            backgroundColor: 'none'
                        }
                    });
                },
                success: function (data) {

                    var table = '<thead><tr class="bg-grey-300"><th>{% trans from 'empresas' %}TRANS_TECNICO{% endtrans %}</th><th>{% trans from 'messages' %}TRANS_ACCIONES{% endtrans %}</th></tr></thead>';

                    table += '<tbody>';

                    if(JSON.parse(data) != ""){
                        var item = 1;

                        $.each(JSON.parse(data), function (key, item) {

                            if (item % 2 == 0) {
                                table += '<tr class="grid-row-cells odd"> ';
                            }
                            else {
                                table += '<tr  class="grid-row-cells even"> ';
                            }

                            if (item["nombre"] != undefined) {
                                table += '<td>' + item["nombre"]+ '</td>';
                            }
                            else {
                                table += '<td></td>';
                            }

                            if (item["id"] != undefined) {
                                table += '<td><div class="list-icons">';

                                {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn is defined and app.session.get('privilegiosRol').editEmpresaTecnicoSn is not null %}
                                {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn and impagadaSn is defined and impagadaSn == false %}
                                table += '<a href="#" data-id="' + item["id"]+ '" target="_self" class="list-icons-item" onclick="recuperaTecnico('+ item["id"]+');" data-toggle="modal" data-target="#modal_editar_tecnico"><i class="icon-pencil7"></i></a>';
                                table += '<a href="#" data-id="' + item["id"]+ '" target="_self" class="list-icons-item eliminarTecnico"><i class="icon-trash"></i></a>';
                                {% endif %}
                                {% endif %}

                                table += '</div></td>';
                            }
                            else {
                                table += '<td></td>';
                            }

                            item++;

                            table += '</tr>';
                        });

                    }else{
                        table += "<tr><td colspan='2' align='center'>{% trans from 'messages' %}TRANS_SIN_REGISTROS{% endtrans %}</td></tr>";
                    }

                    table += "</tbody>";

                    $("#tecnicos").html("");
                    $("#tecnicos").html(table);

                },
                error: function(){
                    new PNotify({
                        title: 'Ops!',
                        text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                        icon: 'icon-blocked',
                        type: 'error'
                    });
                }
            });
        }

        function recuperaTecnico(id) {
            $.ajax({
                type: "POST",
                url: "{{ path('empresa_recupera_tecnico') }}",
                data: {
                    'tecnicoEmpresaId': id
                },
                dataType: "JSON",
                success: function (data) {
                    if (data != null) {
                        $('#tecnicoEditar').val(data.tecnico).change();
                        $('#tecnicoEmpresaId').val(data.id);
                    }
                },
                error: function () {
                    new PNotify({
                        title: 'Ops!',
                        text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                        icon: 'icon-blocked',
                        type: 'error'
                    });
                }
            });
        }

        function deleteTecnico(id) {
            $.ajax({
                type: "POST",
                url: "{{ path('empresa_delete_tecnico') }}",
                data: {
                    'tecnicoEmpresaId': id
                },
                dataType: "JSON",
                success: function (data) {
                    if (data == "OK") {

                        recuperaTecnicos();

                        new PNotify({
                            title: '{% trans from "messages" %}TRANS_AVISO_ELIMINADO{% endtrans %}',
                            text: '{% trans from "messages" %}TRANS_AVISO_ELIMINADO_MSG{% endtrans %}',
                            icon: 'icon-checkmark3',
                            type: 'success'
                        });
                    }
                },
                error: function () {
                    new PNotify({
                        title: 'Ops!',
                        text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                        icon: 'icon-blocked',
                        type: 'error'
                    });
                }
            });
        }

        function recuperaEmails(){
            $.ajax({
                type: "POST",
                url: "{{ path('empresa_recupera_emails') }}",
                data: {
                    'empresaId': '{{ app.request.get('id') }}'
                },
                dataType: "JSON",
                beforeSend: function(data){
                    $("#correos").block({
                        message: '<i class="icon-spinner2 spinner"></i>',
                        overlayCSS: {
                            backgroundColor: '#fff',
                            opacity: 0.8,
                            cursor: 'wait'
                        },
                        css: {
                            border: 0,
                            padding: 0,
                            backgroundColor: 'none'
                        }
                    });
                },
                success: function (data) {

                    var table = '<thead><tr class="bg-grey-300"><th>{% trans from 'empresas' %}TRANS_EMAIL{% endtrans %}</th><th>{% trans from 'empresas' %}TRANS_FUNCION_EMAIL{% endtrans %}</th><th>{% trans from 'messages' %}TRANS_ACCIONES{% endtrans %}</th></tr></thead>';

                    table += '<tbody>';

                    if(JSON.parse(data) != ""){
                        var item = 1;

                        $.each(JSON.parse(data), function (key, item) {

                            if (item % 2 == 0) {
                                table += '<tr class="grid-row-cells odd"> ';
                            }
                            else {
                                table += '<tr  class="grid-row-cells even"> ';
                            }

                            if (item["correo"] != undefined) {
                                table += '<td>' + item["correo"]+ '</td>';
                            }
                            else {
                                table += '<td></td>';
                            }

                            if (item["funcion"] != undefined) {
                                table += '<td>' + item["funcion"]+ '</td>';
                            }
                            else {
                                table += '<td></td>';
                            }

                            if (item["id"] != undefined) {
                                table += '<td><div class="list-icons">';

                                {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn is defined and app.session.get('privilegiosRol').editEmpresaTecnicoSn is not null %}
                                {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn and impagadaSn is defined and impagadaSn == false %}
                                table += '<a href="#" data-id="' + item["id"]+ '" target="_self" class="list-icons-item" onclick="recuperaEmail('+ item["id"]+');" data-toggle="modal" data-target="#modal_editar_email"><i class="icon-pencil7"></i></a>';
                                table += '<a href="#" data-id="' + item["id"]+ '" target="_self" class="list-icons-item eliminarEmail"><i class="icon-trash"></i></a>';
                                {% endif %}
                                {% endif %}

                                table += '</div></td>';
                            }
                            else {
                                table += '<td></td>';
                            }

                            item++;

                            table += '</tr>';
                        });

                    }else{
                        table += "<tr><td colspan='3' align='center'>{% trans from 'messages' %}TRANS_SIN_REGISTROS{% endtrans %}</td></tr>";
                    }

                    table += "</tbody>";

                    $("#correos").html("");
                    $("#correos").html(table);

                },
                error: function(){
                    new PNotify({
                        title: 'Ops!',
                        text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                        icon: 'icon-blocked',
                        type: 'error'
                    });
                }
            });
        }

        function recuperaEmail(id) {
            $.ajax({
                type: "POST",
                url: "{{ path('empresa_recupera_email') }}",
                data: {
                    'correoEmpresaId': id
                },
                dataType: "JSON",
                success: function (data) {
                    if (data != null) {
                        $('#emailEditar').val(data.email);
                        $('#funcionEditar').val(data.funcion).change();
                        $('#correoEmpresaIdEditar').val(data.id);
                    }
                },
                error: function () {
                    new PNotify({
                        title: 'Ops!',
                        text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                        icon: 'icon-blocked',
                        type: 'error'
                    });
                }
            });
        }

        function deleteEmail(id) {
            $.ajax({
                type: "POST",
                url: "{{ path('empresa_delete_email') }}",
                data: {
                    'correoEmpresaId': id
                },
                dataType: "JSON",
                success: function (data) {
                    if (data == "OK") {

                        recuperaEmails();

                        new PNotify({
                            title: '{% trans from "messages" %}TRANS_AVISO_ELIMINADO{% endtrans %}',
                            text: '{% trans from "messages" %}TRANS_AVISO_ELIMINADO_MSG{% endtrans %}',
                            icon: 'icon-checkmark3',
                            type: 'success'
                        });
                    }
                },
                error: function () {
                    new PNotify({
                        title: 'Ops!',
                        text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                        icon: 'icon-blocked',
                        type: 'error'
                    });
                }
            });
        }

        $(document).on('click', 'a.eliminarEmail', function(){
            var id = $(this).data('id');

            bootbox.confirm({
                title: '{% trans from 'messages' %}TRANS_ELIMINAR_EMAIL{% endtrans %}',
                message: '{% trans from 'messages' %}TRANS_CONFIRM_DELETE_REGISTRO{% endtrans %}',
                buttons: {
                    confirm: {
                        label: 'Si',
                        className: 'btn-primary'
                    },
                    cancel: {
                        label: 'No',
                        className: 'btn-link'
                    }
                },
                callback: function (result) {
                    if(result == true){
                        deleteEmail(id)
                    }
                }
            });
        });

        function deleteMaquinaEmpresa(id) {
            $.ajax({
                type: "POST",
                url: "{{ path('tecnico_empresa_maquina_delete') }}",
                data: {
                    'maquinaEmpresaId': id
                },
                dataType: "JSON",
                success: function (data) {
                    if (data == "OK") {
                        location.reload();
                    }
                },
                error: function () {
                    new PNotify({
                        title: 'Ops!',
                        text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                        icon: 'icon-blocked',
                        type: 'error'
                    });
                }
            });
        }

        $(document).on('click', 'a.eliminarMaquinaEmpresa', function(){
            var id = $(this).data('id');

            bootbox.confirm({
                title: '{% trans %}TRANS_DELETE_MAQUINARIA{% endtrans %}',
                message: '{% trans from 'messages' %}TRANS_CONFIRM_DELETE_REGISTRO{% endtrans %}',
                buttons: {
                    confirm: {
                        label: 'Si',
                        className: 'btn-primary'
                    },
                    cancel: {
                        label: 'No',
                        className: 'btn-link'
                    }
                },
                callback: function (result) {
                    if(result == true){
                        deleteMaquinaEmpresa(id)
                    }
                }
            });
        });

        function deleteMaquinaGenerica(id, tipo) {
            $.ajax({
                type: "POST",
                url: "{{ path('tecnico_puesto_trabajo_delete_maquina_generica') }}",
                data: {
                    'maquinaId': id,
                    'tipo': tipo
                },
                dataType: "JSON",
                success: function (data) {
                    if (data == "OK") {
                        location.reload();
                    }
                },
                error: function () {
                    new PNotify({
                        title: 'Ops!',
                        text: '{% trans from "messages" %}TRANS_AVISO_ERROR{% endtrans %}',
                        icon: 'icon-blocked',
                        type: 'error'
                    });
                }
            });
        }

        //Boton que elimina la maquina del puesto de trabajo seleccionado
        $(document).on('click', 'a.eliminarMaquinaGenerica', function(){
            var id = $(this).data('id');
            bootbox.confirm({
                title: '{% trans from 'empresas' %}TRANS_DELETE_MAQUINARIA{% endtrans %}',
                message: '{% trans from 'messages' %}TRANS_CONFIRM_DELETE_REGISTRO{% endtrans %}',
                buttons: {
                    confirm: {
                        label: 'Si',
                        className: 'btn-primary'
                    },
                    cancel: {
                        label: 'No',
                        className: 'btn-link'
                    }
                },
                callback: function (result) {
                    if(result == true){
                        deleteMaquinaGenerica(id, 1)
                    }
                }
            });
        });

        //Boton que elimina la maquina de la zona de trabajo seleccionada
        $(document).on('click', 'a.eliminarMaquinaGenericaZonaTrabajo', function(){
            var id = $(this).data('id');
            bootbox.confirm({
                title: '{% trans from 'empresas' %}TRANS_DELETE_MAQUINARIA{% endtrans %}',
                message: '{% trans from 'messages' %}TRANS_CONFIRM_DELETE_REGISTRO{% endtrans %}',
                buttons: {
                    confirm: {
                        label: 'Si',
                        className: 'btn-primary'
                    },
                    cancel: {
                        label: 'No',
                        className: 'btn-link'
                    }
                },
                callback: function (result) {
                    if(result == true){
                        deleteMaquinaGenerica(id, 2)
                    }
                }
            });
        });

        //Boton que elimina la maquina del puesto de trabajo seleccionado
        $(document).on('click', 'a.eliminarMaquinaEmpresa', function(){
            var id = $(this).data('id');
            bootbox.confirm({
                title: '{% trans from 'empresas' %}TRANS_DELETE_MAQUINARIA{% endtrans %}',
                message: '{% trans from 'messages' %}TRANS_CONFIRM_DELETE_REGISTRO{% endtrans %}',
                buttons: {
                    confirm: {
                        label: 'Si',
                        className: 'btn-primary'
                    },
                    cancel: {
                        label: 'No',
                        className: 'btn-link'
                    }
                },
                callback: function (result) {
                    if(result == true){
                        deleteMaquinaGenerica(id, 3)
                    }
                }
            });
        });

        //Boton que elimina la maquina de la zona de trabajo seleccionada
        $(document).on('click', 'a.eliminarMaquinaEmpresaZonaTrabajo', function(){
            var id = $(this).data('id');
            bootbox.confirm({
                title: '{% trans from 'empresas' %}TRANS_DELETE_MAQUINARIA{% endtrans %}',
                message: '{% trans from 'messages' %}TRANS_CONFIRM_DELETE_REGISTRO{% endtrans %}',
                buttons: {
                    confirm: {
                        label: 'Si',
                        className: 'btn-primary'
                    },
                    cancel: {
                        label: 'No',
                        className: 'btn-link'
                    }
                },
                callback: function (result) {
                    if(result == true){
                        deleteMaquinaGenerica(id, 4)
                    }
                }
            });
        });

    </script>

    {% for message in app.flashes('success') %}
        <div class="alert alert-success bg-white alert-styled-left alert-arrow-left alert-dismissible">
            <button type="button" class="close" data-dismiss="alert"><span>×</span></button>
            {{ message }}
        </div>
    {% endfor %}

    {% for message in app.flashes('danger') %}
        <div class="alert alert-danger bg-white alert-styled-left alert-arrow-left alert-dismissible">
            <button type="button" class="close" data-dismiss="alert"><span>×</span></button>
            {{ message }}
        </div>
    {% endfor %}

    <div class="card">
        <div class="card-body">

            {{ form_start(form) }}

            <ul class="nav nav-tabs nav-tabs-highlight" id="tabs">

                {% if (app.request.get('id') is defined and app.request.get('id') is not empty ) %}
                    <li class="nav-item"><a href="#tab1" class="nav-link active" data-toggle="tab">{% trans %}TRANS_MENU_1{% endtrans %}</a></li>
                    <li class="nav-item"><a href="#tab9" class="nav-link" data-toggle="tab">{% trans from 'messages' %}TRANS_MENU_TEC_PUESTOS_TRABAJO{% endtrans %}</a></li>
                    <li class="nav-item"><a href="#tab3" class="nav-link" data-toggle="tab">{% trans %}TRANS_MENU_7{% endtrans %}</a></li>
                    <li class="nav-item"><a href="#tab2" class="nav-link" data-toggle="tab">{% trans %}TRANS_MENU_6{% endtrans %}</a></li>
                    <li class="nav-item"><a href="#tab7" class="nav-link" data-toggle="tab">{% trans %}TRANS_PLA_PREVENCION{% endtrans %}</a></li>
                    <li class="nav-item"><a href="#tab5" class="nav-link" data-toggle="tab">{% trans %}TRANS_EVALUACIONES{% endtrans %}</a></li>
                    <li class="nav-item"><a href="#tab4" class="nav-link" data-toggle="tab">{% trans %}TRANS_ACCIDENTES{% endtrans %}</a></li>
                    <li class="nav-item"><a href="#tab12" class="nav-link" data-toggle="tab">{% trans %}TRANS_PROTOCOLO_ACOSO{% endtrans %}</a></li>
                    {#                    <li class="nav-item"><a href="#tab6" class="nav-link" data-toggle="tab">{% trans %}TRANS_MAQUINARIA{% endtrans %}</a></li>#}
                    <li class="nav-item"><a href="#tab11" class="nav-link" data-toggle="tab">{% trans %}TRANS_MENU_13{% endtrans %}</a></li>
                    <li class="nav-item"><a href="#tab8" class="nav-link" data-toggle="tab">{% trans %}TRANS_GESTION_DOCUMENTAL{% endtrans %}</a></li>
                    <!--Peticio 01/09/2023-->
                    <li class="nav-item"><a href="#tab13" class="nav-link" data-toggle="tab">Hojas actuación</a></li>
                    {#                    <li class="nav-item"><a href="#tab10" class="nav-link" data-toggle="tab">{% trans %}TRANS_MAQUINARIA_PUESTO_TRABAJO{% endtrans %}</a></li>#}


                {% else %}
                    <li class="nav-item"><a href="#tab1" class="nav-link active" data-toggle="tab">{% trans %}TRANS_MENU_1{% endtrans %}</a></li>
                    <li class="nav-item"><a href="#" class="nav-link" onclick="alert('{% trans from "messages" %}TRANS_MSG_GUARDAR_ANTES{% endtrans %}');">{% trans %}TRANS_MENU_TEC_PUESTOS_TRABAJO{% endtrans %}</a></li>
                    <li class="nav-item"><a href="#" class="nav-link" onclick="alert('{% trans from "messages" %}TRANS_MSG_GUARDAR_ANTES{% endtrans %}');">{% trans %}TRANS_MENU_7{% endtrans %}</a></li>
                    <li class="nav-item"><a href="#" class="nav-link" onclick="alert('{% trans from "messages" %}TRANS_MSG_GUARDAR_ANTES{% endtrans %}');">{% trans %}TRANS_MENU_6{% endtrans %}</a></li>
                    <li class="nav-item"><a href="#" class="nav-link" onclick="alert('{% trans from "messages" %}TRANS_MSG_GUARDAR_ANTES{% endtrans %}');">{% trans %}TRANS_PLA_PREVENCION{% endtrans %}</a></li>
                    <li class="nav-item"><a href="#" class="nav-link" onclick="alert('{% trans from "messages" %}TRANS_MSG_GUARDAR_ANTES{% endtrans %}');">{% trans %}TRANS_EVALUACIONES{% endtrans %}</a></li>
                    <li class="nav-item"><a href="#" class="nav-link" onclick="alert('{% trans from "messages" %}TRANS_MSG_GUARDAR_ANTES{% endtrans %}');">{% trans %}TRANS_ACCIDENTES{% endtrans %}</a></li>
                    <li class="nav-item"><a href="#" class="nav-link" onclick="alert('{% trans from "messages" %}TRANS_MSG_GUARDAR_ANTES{% endtrans %}');">{% trans %}TRANS_PROTOCOLO_ACOSO{% endtrans %}</a></li>
                    <li class="nav-item"><a href="#" class="nav-link" onclick="alert('{% trans from "messages" %}TRANS_MSG_GUARDAR_ANTES{% endtrans %}');">{% trans %}TRANS_MENU_13{% endtrans %}</a></li>
                    {#                    <li class="nav-item"><a href="#" class="nav-link" onclick="alert('{% trans from "messages" %}TRANS_MSG_GUARDAR_ANTES{% endtrans %}');">{% trans %}TRANS_MAQUINARIA{% endtrans %}</a></li>#}
                    <li class="nav-item"><a href="#" class="nav-link" onclick="alert('{% trans from "messages" %}TRANS_MSG_GUARDAR_ANTES{% endtrans %}');">{% trans %}TRANS_GESTION_DOCUMENTAL{% endtrans %}</a></li>
                    <!--Peticio 01/09/2023-->
                    <li class="nav-item"><a href="#tab13" class="nav-link" data-toggle="tab">Hojas actuación</a></li>
                    {#                    <li class="nav-item"><a href="#" class="nav-link" onclick="alert('{% trans from "messages" %}TRANS_MSG_GUARDAR_ANTES{% endtrans %}');">{% trans %}TRANS_MAQUINARIA_PUESTO_TRABAJO{% endtrans %}</a></li>#}


                {% endif %}

            </ul>

            <div class="tab-content">
                <div class="tab-pane fade active show" id="tab1">
                    <div class="row">
                        <div class="col-lg-4">
                            {#                            {% trans %}TRANS_ESTADO{% endtrans %}#}
                            {#                            {{ form_row(form.anulado) }}#}
                            {{ form_row(form.estadoAdministrativoPrevencion) }}
                        </div>
                        <div class="col-lg-4">
                            {{ form_row(form.codigo) }}
                        </div>
                        <div class="col-lg-4">
                            {{ form_row(form.idioma) }}
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-4">
                            {{ form_row(form.cif) }}
                            <span class="form-text text-danger incorrectoCif" style="display: none;">{% trans %}TRANS_ERROR_CIF{% endtrans %}</span>
                        </div>
                        <div class="col-lg-4">
                            {{ form_row(form.empresa) }}
                        </div>
                        <div class="col-lg-4">
                            {{ form_row(form.marcaComercial) }}
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-4">
                            {{ form_row(form.grupoEmpresa) }}
                        </div>
                        <div class="col-lg-4">
                            {{ form_row(form.logo) }}
                            {% if logo is defined and logo is not empty %}
                                <label style="font-weight: bolder;">{% trans %}TRANS_LOGO_ACTUAL{% endtrans %}</label>
                                <img src="../../../upload/media/logos/{{ logo }}" width="255px" />
                            {% endif %}
                        </div>
                        <div class="col-lg-4">
                            {{ form_row(form.fechaContrato) }}
                        </div>
                    </div>

                    <fieldset>
                        <legend class="text-uppercase font-size-sm font-weight-bold">{% trans %}TRANS_OTROS_DATOS_INTERES{% endtrans %}</legend>
                        <div class="row">
                            <div class="col-lg-4">
                                {{ form_row(form.colaborador) }}
                            </div>
                            <div class="col-lg-4">
                                {{ form_row(form.mutua) }}
                            </div>
                            <div class="col-lg-4">
                                {{ form_row(form.modalidadPreventiva) }}
                            </div>
                        </div>
                    </fieldset>

                    <fieldset>
                        <legend class="text-uppercase font-size-sm font-weight-bold">{% trans %}TRANS_TELEFONO_EMAIL{% endtrans %}</legend>

                        <div class="row">
                            <div class="col-lg-4">
                                {{ form_row(form.telefono1) }}
                            </div>
                            <div class="col-lg-4">
                                {{ form_row(form.telefono2) }}
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-lg-12">
                                <div class="col-lg-12">
                                    {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn is defined and app.session.get('privilegiosRol').editEmpresaTecnicoSn is not null %}
                                        {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn and impagadaSn is defined and impagadaSn == false %}
                                            <a href="#" class="btn btn-labeled btn-labeled-left bg-grey-300" data-toggle="modal" data-target="#modal_añadir_email">{% trans from 'messages' %}TRANS_AÑADIR_EMAIL{% endtrans %}<b><i class="icon-plus3"></i></b></a>
                                        {% endif %}
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        <br/>

                        <div class="row">
                            <div class="col-lg-12">
                                <div class="table-bordered">
                                    <table class="table" id="correos">
                                        <thead>
                                        <tr class="bg-grey-300">
                                            <th>{% trans %}TRANS_EMAIL{% endtrans %}</th>
                                            <th>{% trans %}TRANS_FUNCION_EMAIL{% endtrans %}</th>
                                            <th>{% trans from 'messages' %}TRANS_ACCIONES{% endtrans %}</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        {% if correos is not empty %}
                                            {% for c in correos %}
                                                <tr>
                                                    <td>{{ c.correo }}</td>
                                                    {% if c.funcion is not null %}
                                                        <td>{{ c.funcion.descripcion }}</td>
                                                    {% else %}
                                                        <td></td>
                                                    {% endif %}
                                                    <td>
                                                        <div class="list-icons">
                                                            {% if app.session.get('privilegiosRol').editEmpresaSn is defined and app.session.get('privilegiosRol').editEmpresaSn is not null %}
                                                                {% if app.session.get('privilegiosRol').editEmpresaSn and impagadaSn is defined and impagadaSn == false %}
                                                                    <a href="#" data-id="{{ c.id }}" target="_self" class="list-icons-item" onclick="recuperaEmail('{{ c.id }}');" data-toggle="modal" data-target="#modal_editar_email"><i class="icon-pencil7"></i></a>
                                                                    <a href="#" data-id="{{ c.id }}" target="_self" class="list-icons-item eliminarEmail"><i class="icon-trash"></i></a>
                                                                {% endif %}
                                                            {% endif %}
                                                        </div>
                                                    </td>
                                                </tr>
                                            {% endfor %}
                                        {% else %}
                                            <tr>
                                                <td colspan="3" align="center">{% trans from 'messages' %}TRANS_SIN_REGISTROS{% endtrans %}</td>
                                            </tr>
                                        {% endif %}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </fieldset>

                    <fieldset>
                        <legend class="text-uppercase font-size-sm font-weight-bold">{% trans %}TRANS_USUARIOS_RESPONSABLES{% endtrans %}</legend>
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="col-lg-12">
                                    {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn is defined and app.session.get('privilegiosRol').editEmpresaTecnicoSn is not null %}
                                        {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn and app.request.get('id') is defined and app.request.get('id') is not empty and impagadaSn is defined and impagadaSn == false %}
                                            <a href="#" class="btn btn-labeled btn-labeled-left bg-grey-300" data-toggle="modal" data-target="#modal_añadir_tecnico">{% trans from 'messages' %}TRANS_AÑADIR_TECNICO{% endtrans %}<b><i class="icon-plus3"></i></b></a>
                                        {% endif %}
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        <br/>
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="table-bordered">
                                    <table class="table" id="tecnicos">
                                        <thead>
                                        <tr class="bg-grey-300">
                                            <th>{% trans %}TRANS_TECNICO{% endtrans %}</th>
                                            <th>{% trans from 'messages' %}TRANS_ACCIONES{% endtrans %}</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        {% if tecnicos is not empty %}
                                            {% for t in tecnicos %}
                                                <tr>
                                                    {% if t.tecnico is not null %}
                                                        <td>{{ t.tecnico.nombre }}</td>
                                                    {% else %}
                                                        <td></td>
                                                    {% endif %}
                                                    <td>
                                                        <div class="list-icons">
                                                            {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn is defined and app.session.get('privilegiosRol').editEmpresaTecnicoSn is not null %}
                                                                {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn and impagadaSn is defined and impagadaSn == false %}
                                                                    <a href="#" data-id="{{ t.id }}" target="_self" class="list-icons-item" onclick="recuperaTecnico('{{ t.id }}');" data-toggle="modal" data-target="#modal_editar_tecnico"><i class="icon-pencil7"></i></a>
                                                                    <a href="#" data-id="{{ t.id }}" target="_self" class="list-icons-item eliminarTecnico"><i class="icon-trash"></i></a>
                                                                {% endif %}
                                                            {% endif %}
                                                        </div>
                                                    </td>
                                                </tr>
                                            {% endfor %}
                                        {% else %}
                                            <tr>
                                                <td colspan="2" align="center">{% trans from 'messages' %}TRANS_SIN_REGISTROS{% endtrans %}</td>
                                            </tr>
                                        {% endif %}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <br/>

                        <div class="row">
                            <div class="col-lg-4">
                                {{ form_row(form.agente) }}
                            </div>
                            <div class="col-lg-4">
                                {{ form_row(form.vigilanciaSalud) }}
                            </div>
                            <div class="col-lg-4">
                                {{ form_row(form.gestorAdministrativo) }}
                            </div>
                        </div>
                    </fieldset>

                    <fieldset>
                        <legend class="text-uppercase font-size-sm font-weight-bold">{% trans %}TRANS_RESPONSABLE_EMPRESA{% endtrans %}</legend>
                        <div class="row">
                            <div class="col-lg-4">
                                {{ form_row(form.nombreRepresentante) }}
                            </div>
                            <div class="col-lg-4">
                                {{ form_row(form.dniRepresentante) }}
                            </div>
                            <div class="col-lg-4">
                                {{ form_row(form.cargoRepresentante) }}
                            </div>
                        </div>
                    </fieldset>

                    <fieldset>
                        <legend class="text-uppercase font-size-sm font-weight-bold">{% trans %}TRANS_PERSONAS_CONTACTO{% endtrans %}</legend>
                        <div class="row">
                            <div class="col-lg-12">
                                {{ form_row(form.personaContacto) }}
                            </div>
                        </div>
                    </fieldset>

                    <fieldset>
                        <legend class="text-uppercase font-size-sm font-weight-bold">{% trans %}TRANS_DIRECCION_POSTAL{% endtrans %}</legend>
                        <div class="row">
                            <div class="col-lg-3">
                                {{ form_row(form.domicilioPostal) }}
                            </div>
                            <div class="col-lg-3">
                                {{ form_row(form.localidadPostal) }}
                            </div>
                            <div class="col-lg-3">
                                {{ form_row(form.codigoPostalPostal) }}
                            </div>
                            <div class="col-lg-3">
                                {{ form_row(form.provinciaPostal) }}
                            </div>
                        </div>

                        <h5>{% trans %}TRANS_CODIGO_SERPA{% endtrans %}</h5>

                        <div class="row">
                            <div class="col-lg-6">
                                {{ form_row(form.provinciaPostalSerpa) }}
                            </div>
                            <div class="col-lg-6">
                                {{ form_row(form.municipioPostalSerpa) }}
                            </div>
                        </div>
                    </fieldset>

                    <fieldset>
                        <legend class="text-uppercase font-size-sm font-weight-bold">{% trans %}TRANS_CNAE{% endtrans %}</legend>
                        <div class="row">
                            <div class="col-lg-12">
                                {% if (app.request.get('id') is defined and app.request.get('id') is not empty ) %}
                                    {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn is defined and app.session.get('privilegiosRol').editEmpresaTecnicoSn is not null %}
                                        {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn and impagadaSn is defined and impagadaSn == false %}
                                            <a href="#" class="btn btn-labeled btn-labeled-left bg-grey-300" data-toggle="modal" data-target="#modal_añadir_cnae">{% trans from 'messages' %}TRANS_AÑADIR_CNAE{% endtrans %}<b><i class="icon-plus3"></i></b></a>
                                        {% endif %}
                                    {% endif %}
                                {% endif %}
                            </div>
                        </div>
                        <br/>
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="table-bordered">
                                    <table class="table" id="cnae">
                                        <thead>
                                        <tr class="bg-grey-300">
                                            <th>{% trans %}TRANS_PRINCIPAL_CNAE{% endtrans %}</th>
                                            <th>{% trans %}TRANS_CODIGO_CNAE{% endtrans %}</th>
                                            <th>{% trans %}TRANS_DESCRIPCION_CNAE{% endtrans %}</th>
                                            <th>{% trans from 'messages' %}TRANS_ACCIONES{% endtrans %}</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        {% if cnae is not empty %}
                                            {% for c in cnae %}
                                                <tr>
                                                    {% if c.principal == true %}
                                                        <td><span class="badge badge-flat border-success text-success-600"><i class="icon-checkmark2"></i></span></td>
                                                    {% else %}
                                                        <td><span class="badge badge-flat border-danger text-danger-600"><i class="icon-cross3"></i></span></td>
                                                    {% endif %}
                                                    {% if c.cnae is not null %}
                                                        <td>{{ c.cnae.cnae }}</td>
                                                        <td>{{ c.cnae.descripcion }}</td>
                                                    {% else %}
                                                        <td></td>
                                                        <td></td>
                                                    {% endif %}
                                                    <td>
                                                        <div class="list-icons">
                                                            {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn is defined and app.session.get('privilegiosRol').editEmpresaTecnicoSn is not null %}
                                                                {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn and impagadaSn is defined and impagadaSn == false %}
                                                                    <a href="#" data-id="{{ c.id }}" target="_self" class="list-icons-item" onclick="recuperaCnae('{{ c.id }}');" data-toggle="modal" data-target="#modal_editar_cnae"><i class="icon-pencil7"></i></a>
                                                                    <a href="#" data-id="{{ c.id }}" target="_self" class="list-icons-item eliminarCnae"><i class="icon-trash"></i></a>
                                                                {% endif %}
                                                            {% endif %}
                                                        </div>
                                                    </td>
                                                </tr>
                                            {% endfor %}
                                        {% else %}
                                            <tr>
                                                <td colspan="4" align="center">{% trans from 'messages' %}TRANS_SIN_REGISTROS{% endtrans %}</td>
                                            </tr>
                                        {% endif %}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </fieldset>

                    <fieldset>
                        <legend class="text-uppercase font-size-sm font-weight-bold">{% trans %}TRANS_PROCESO_PRODUCTIVO{% endtrans %}</legend>
                        <div class="row">
                            <div class="col-lg-12">
                                {{ form_widget(form.procesoProductivo) }}
                            </div>
                        </div>
                    </fieldset>

                    <fieldset>
                        <legend class="text-uppercase font-size-sm font-weight-bold">{% trans %}TRANS_OBS_GEN{% endtrans %}</legend>
                        <div class="row">
                            <div class="col-lg-12">
                                {{ form_widget(form.observacionesGenerales) }}
                            </div>
                        </div>
                    </fieldset>
                </div>

                <div class="tab-pane fade" id="tab2">
                    <div class="row">
                        <div class="col-lg-12">
                            {{ form_row(form.centroTrabajoDeslocalizado) }}
                        </div>
                    </div>
                    <br/>
                    <div class="row">
                        <div class="col-lg-12">
                            {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn is defined and app.session.get('privilegiosRol').editEmpresaTecnicoSn is not null %}
                                {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn and impagadaSn is defined and impagadaSn == false %}
                                    <a href="#" class="btn btn-labeled btn-labeled-left bg-grey-300" data-toggle="modal" data-target="#modal_añadir_centro">{% trans %}TRANS_AÑADIR_CENTRO{% endtrans %}<b><i class="icon-plus3"></i></b></a>
                                {% endif %}
                            {% endif %}
                        </div>
                    </div>
                    <br/>
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="table-bordered">
                                <table class="table" id="centroTrabajoEmpresa">
                                    <thead>
                                    <tr class="bg-grey-300">
                                        <th>{% trans %}TRANS_DIRECCION{% endtrans %}</th>
                                        <th>{% trans %}TRANS_ACTIVO{% endtrans %}</th>
                                        <th>{% trans from 'messages' %}TRANS_ACCIONES{% endtrans %}</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    {% if centroTrabajoEmpresa is not empty %}
                                        {% for cte in centroTrabajoEmpresa %}
                                            <tr>
                                                <td>{{ cte.centro.direccion }}</td>
                                                {% if cte.anulado %}
                                                    <td><span class="badge badge-flat border-danger text-danger-600"><i class="icon-cross3"></i></span></td>
                                                {% else %}
                                                    <td><span class="badge badge-flat border-success text-success-600"><i class="icon-checkmark2"></i></span> </td>
                                                {% endif %}
                                                <td>
                                                    <div class="list-icons">
                                                        {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn is defined and app.session.get('privilegiosRol').editEmpresaTecnicoSn is not null %}
                                                            {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn and impagadaSn is defined and impagadaSn == false %}
                                                                <a href="{{ path('centro_update', { "id": cte.centro.id }) }}" class="list-icons-item" class="list-icons-item" data-popup="tooltip" title="Editar" data-container="body"><i class="icon-pencil7"></i></a>
                                                            {% endif %}
                                                        {% endif %}
                                                        {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn is defined and app.session.get('privilegiosRol').editEmpresaTecnicoSn is not null %}
                                                            {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn and impagadaSn is defined and impagadaSn == false %}
                                                                <a href="#" data-id="{{ cte.id }}" target="_self" class="list-icons-item eliminarCentroTrabajo"><i class="icon-trash"></i></a>
                                                            {% endif %}
                                                        {% endif %}
                                                    </div>
                                                </td>
                                            </tr>
                                        {% endfor %}
                                    {% else %}
                                        <tr>
                                            <td colspan="2" align="center">{% trans from 'messages' %}TRANS_SIN_REGISTROS{% endtrans %}</td>
                                        </tr>
                                    {% endif %}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tab-pane fade" id="tab3">
                    <div class="row">
                        <div class="col-lg-12">

                            {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn is defined and app.session.get('privilegiosRol').editEmpresaTecnicoSn is not null and impagadaSn is defined and impagadaSn == false %}
                                {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn %}
                                    <a href="{{ path('tecnico_trabajador_create') }}" class="btn btn-labeled btn-labeled-left bg-primary">{% trans %}TRANS_CREAR_TRABAJADOR{% endtrans %}<b><i class="icon-plus3"></i></b></a>
                                {% endif %}
                            {% endif %}

                            {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn is defined and app.session.get('privilegiosRol').editEmpresaTecnicoSn is not null %}
                                {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn and impagadaSn is defined and impagadaSn == false %}
                                    <a href="#" class="btn btn-labeled btn-labeled-left bg-grey-300" data-toggle="modal" data-target="#modal_añadir_trabajador">{% trans %}TRANS_ASIGNAR_TRABAJADOR{% endtrans %}<b><i class="icon-plus3"></i></b></a>
                                {% endif %}
                            {% endif %}

                            {% if app.session.get('privilegiosRol').importTrabajadorSn is defined and app.session.get('privilegiosRol').importTrabajadorSn is not null %}
                                {% if app.session.get('privilegiosRol').importTrabajadorSn %}
                                    <a href="#" class="btn btn-labeled btn-labeled-left bg-slate" style="margin-left: 5px;" data-toggle="modal" data-target="#modal_import_trabajador">{% trans from 'trabajadores' %}TRANS_IMPORTAR_TRABAJADORES{% endtrans %}<b><i class="icon-import"></i></b></a>
                                {% endif %}
                            {% endif %}

                            {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn is defined and app.session.get('privilegiosRol').editEmpresaTecnicoSn is not null %}
                                {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn and impagadaSn is defined and impagadaSn == false %}
                                    <a href="#" class="btn btn-labeled btn-labeled-left bg-brown" data-toggle="modal" data-target="#modal_añadir_puesto_trabajo_multiple">{% trans %}TRANS_ASIGNAR_PUESTO_TRABAJO_MULTIPLE{% endtrans %}<b><i class="icon-plus3"></i></b></a>
                                {% endif %}
                            {% endif %}
                        </div>
                    </div>

                    <br/>

                    <div class="row">
                        <div class="col-lg-12">
                            <div id="datatable-trabajadores" class="dataTables_wrapper no-footer">
                                <div class="datatable-scroll">
                                    <table class="table datatable-export-excel-trabajadores dataTable no-footer" id="trabajadoresEmpresa" role="grid" aria-describedby="DataTables_Table_0_info" style="width: 100% !important;">
                                        <thead>
                                        <tr class="bg-grey-300" role="row">
                                            <th class="sorting_disabled" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
                                                aria-label="Estado">{% trans from 'trabajadores' %}TRANS_ESTADO{% endtrans %}
                                            </th>
                                            <th class="sorting_asc" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
                                                aria-label="Nombre" aria-sort="ascending">{% trans %}TRANS_NOMBRE{% endtrans %}
                                            </th>
                                            <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
                                                aria-label="DNI">{% trans %}TRANS_DNI_RESPONSABLE_EMPRESA{% endtrans %}
                                            </th>
                                            <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
                                                aria-label="Puesto">{% trans from 'revision' %}TRANS_PUESTO_TRABAJO{% endtrans %}
                                            </th>
                                            <th class="text-center sorting_disabled" rowspan="1" colspan="1" aria-label="Actions"
                                                style="width: 100px;">{% trans from 'messages' %}TRANS_ACCIONES{% endtrans %}
                                            </th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tab-pane fade" id="tab4">
                    <div class="row">
                        <div class="col-lg-12">
                            {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn is defined and app.session.get('privilegiosRol').editEmpresaTecnicoSn is not null %}
                                {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn and impagadaSn is defined and impagadaSn == false %}
                                    <a href="#" class="btn btn-labeled btn-labeled-left bg-grey-300" data-toggle="modal" data-target="#modal_añadir_accidente">{% trans %}TRANS_AÑADIR_ACCIDENTE{% endtrans %}<b><i class="icon-plus3"></i></b></a>
                                {% endif %}
                            {% endif %}
                        </div>
                    </div>
                    <br/>
                    <div class="row">
                        <div class="col-lg-12">
                            <div id="datatable-accidentes" class="dataTables_wrapper no-footer">
                                <div class="datatable-scroll">
                                    <table class="table datatable-export-excel-accidentes dataTable no-footer" id="accidentesEmpresa" role="grid" aria-describedby="DataTables_Table_0_info" style="width: 100% !important;">
                                        <thead>
                                        <tr class="bg-grey-300" role="row">
                                            <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
                                                aria-label="Trabajador" aria-sort="ascending">{% trans %}TRANS_TRABAJADOR{% endtrans %}
                                            </th>
                                            <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
                                                aria-label="Fecha">{% trans %}TRANS_FECHA_MODELO_347{% endtrans %}
                                            </th>
                                            <th class="text-center sorting_disabled" rowspan="1" colspan="1" aria-label="Actions"
                                                style="width: 100px;">{% trans from 'messages' %}TRANS_ACCIONES{% endtrans %}
                                            </th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tab-pane fade" id="tab5">
                    <div class="row">
                        <div class="col-lg-12">
                            {% if app.session.get('privilegiosRol').addEvaluacionSn is defined and app.session.get('privilegiosRol').addEvaluacionSn is not null %}
                                {% if app.session.get('privilegiosRol').addEvaluacionSn and impagadaSn is defined and impagadaSn == false %}
                                    <a href="#" class="btn btn-labeled btn-labeled-left bg-grey-300" data-toggle="modal" data-target="#mdal_crear_evaluacion">{% trans from 'evaluacion' %}TRANS_NUEVA_EVALUACION{% endtrans %}<b><i class="icon-plus3"></i></b></a>
                                {% endif %}
                            {% endif %}
                        </div>
                    </div>
                    <br/>
                    <div class="row">
                        <div class="col-lg-12">
                            <div id="datatable-evaluaciones" class="dataTables_wrapper no-footer">
                                <div class="datatable-scroll">
                                    <table class="table datatable-export-excel-evaluaciones dataTable no-footer" id="evaluacionesEmpresa" role="grid"
                                           aria-describedby="DataTables_Table_0_info" style="width: 100% !important;">
                                        <thead>
                                        <tr class="bg-grey-300" role="row">
                                            <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
                                                aria-label="Centro">{% trans from 'evaluacion' %}TRANS_CENTRO{% endtrans %}
                                            </th>
                                            <!--Peticio 28/07/2023-->
                                            <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
                                                aria-label="Número">{% trans %}Número{% endtrans %}
                                            </th>
                                            <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
                                                aria-label="Inicio">{% trans from 'evaluacion' %}TRANS_FECHA_INICIO{% endtrans %}
                                            </th>
                                            <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
                                                aria-label="Fin">{% trans from 'evaluacion' %}TRANS_FECHA_FIN{% endtrans %}
                                            </th>
                                            <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
                                                aria-label="Evaluación">{% trans from 'evaluacion' %}TRANS_EVALUACION{% endtrans %}
                                            </th>
                                            <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
                                                aria-label="Tipo">{% trans from 'evaluacion' %}TRANS_METODOLOGIA{% endtrans %}
                                            </th>
                                            <th class="text-center sorting_disabled" rowspan="1" colspan="1" aria-label="Actions"
                                                style="width: 100px;">{% trans from 'messages' %}TRANS_ACCIONES{% endtrans %}
                                            </th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tab-pane fade" id="tab6">
                    <div class="row">
                        <div class="col-lg-12">
                            {% if app.session.get('privilegiosRol').addMaquinaEmpresaSn is defined and app.session.get('privilegiosRol').addMaquinaEmpresaSn is not null %}
                                {% if app.session.get('privilegiosRol').addMaquinaEmpresaSn and impagadaSn is defined and impagadaSn == false %}
                                    <a href="{{ path('tecnico_empresa_maquina_create') }}" class="btn btn-labeled btn-labeled-left bg-grey-300">{% trans %}TRANS_AÑADIR_MAQUINARIA{% endtrans %}<b><i class="icon-plus3"></i></b></a>
                                {% endif %}
                            {% endif %}
                        </div>
                    </div>
                    <br/>
                    <div class="row">
                        <div class="col-lg-12">
                            <div id="datatable-maquinaria" class="dataTables_wrapper no-footer">
                                <div class="datatable-scroll">
                                    <table class="table datatable-export-excel-maquinaria dataTable no-footer" role="grid"
                                           aria-describedby="DataTables_Table_0_info" style="width: 100% !important;">
                                        <thead>
                                        <tr class="bg-grey-300" role="row">
                                            <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
                                                aria-label="Centro">{% trans  %}TRANS_CENTRO_TRABAJO{% endtrans %}
                                            </th>
                                            <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
                                                aria-label="Maquina">{% trans %}TRANS_MAQUINA{% endtrans %}
                                            </th>
                                            <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
                                                aria-label="Grupo">{% trans  %}TRANS_GRUPO_MAQUINARIA{% endtrans %}
                                            </th>
                                            <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
                                                aria-label="Generica">{% trans  %}TRANS_MAQUINARIA_GENERICA{% endtrans %}
                                            </th>
                                            <th class="text-center sorting_disabled" rowspan="1" colspan="1" aria-label="Actions"
                                                style="width: 100px;">{% trans from 'messages' %}TRANS_ACCIONES{% endtrans %}
                                            </th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tab-pane fade" id="tab7">
                    <div class="row">
                        <div class="col-lg-12">
                            {% if app.session.get('privilegiosRol').addPlanPrevencionSn is defined and app.session.get('privilegiosRol').addPlanPrevencionSn is not null %}
                                {% if app.session.get('privilegiosRol').addPlanPrevencionSn and impagadaSn is defined and impagadaSn == false %}
                                    <a href="#" class="btn btn-labeled btn-labeled-left bg-grey-300" data-toggle="modal" data-target="#modal_añadir_plan_prevencion">{% trans %}TRANS_NUEVO_PLAN_PREVENCION{% endtrans %}<b><i class="icon-plus3"></i></b></a>
                                {% endif %}
                            {% endif %}
                        </div>
                    </div>
                    <br/>
                    <div class="row">
                        <div class="col-lg-12">
                            <div id="datatable-plan-prevencion" class="dataTables_wrapper no-footer">
                                <div class="datatable-scroll">
                                    <table class="table datatable-export-excel-plan-prevencion dataTable no-footer" id="planPrevencion" role="grid"
                                           aria-describedby="DataTables_Table_0_info" style="width: 100% !important;">
                                        <thead>
                                        <tr class="bg-grey-300" role="row">
                                            <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
                                                aria-label="Fecha">{% trans %}TRANS_FECHA_MODELO_347{% endtrans %}
                                            </th>
                                            <!--Peticio 28/07/2023-->
                                            <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
                                                aria-label="Número">{% trans %}Número{% endtrans %}
                                            </th>
                                            <th class="text-center sorting_disabled" rowspan="1" colspan="1" aria-label="Actions"
                                                style="width: 100px;">{% trans from 'messages' %}TRANS_ACCIONES{% endtrans %}
                                            </th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tab-pane fade" id="tab8">
                    <div class="row">
                        <div class="col-lg-12">
                            {% if app.session.get('privilegiosRol').addGdocSn is defined and app.session.get('privilegiosRol').addGdocSn is not null %}
                                {% if app.session.get('privilegiosRol').addGdocSn and impagadaSn is defined and impagadaSn == false %}
                                    <a href="#" class="btn btn-labeled btn-labeled-left bg-primary" style="margin-right: 10px;" data-toggle="modal" data-target="#modal_añadir_carpeta">{% trans from 'gdoc' %}TRANS_ADD_CARPETA{% endtrans %}<b><i class="icon-folder-plus"></i></b></a>
                                {% endif %}
                            {% endif %}

                            {% if app.session.get('privilegiosRol').addGdocFileSn is defined and app.session.get('privilegiosRol').addGdocFileSn is not null %}
                                {% if app.session.get('privilegiosRol').addGdocFileSn and impagadaSn is defined and impagadaSn == false %}
                                    <a href="#" class="btn btn-labeled btn-labeled-left bg-success" data-toggle="modal" data-target="#modal_añadir_fichero">{% trans from 'gdoc' %}TRANS_AÑADIR_FICHERO{% endtrans %}<b><i class="icon-file-upload"></i></b></a>
                                {% endif %}
                            {% endif %}
                        </div>
                    </div>

                    <br/>

                    <div class="row">
                        <div class="col-lg-12">
                            <div id="tree" style="border: 1px solid #DDD; border-radius: 5px; padding:20px; margin:0 auto;"></div>
                        </div>
                    </div>
                </div>
                <!--Peticio 01/09/2023-->
                <div class="tab-pane fade" id="tab13">
                    <div class="row">
                        <div class="col-lg-12">
                            <!--{% if app.session.get('privilegiosRol').addGdocSn is defined and app.session.get('privilegiosRol').addGdocSn is not null %}
                                {% if app.session.get('privilegiosRol').addGdocSn and impagadaSn is defined and impagadaSn == false %}
                                    <a href="#" class="btn btn-labeled btn-labeled-left bg-primary" style="margin-right: 10px;" data-toggle="modal" data-target="#modal_añadir_carpeta_fecha">Añadir fecha hoja actuación<b><i class="icon-folder-plus"></i></b></a>
                                {% endif %}
                            {% endif %}-->
                            {% if app.session.get('privilegiosRol').addGdocFileSn is defined and app.session.get('privilegiosRol').addGdocFileSn is not null %}
                                {% if app.session.get('privilegiosRol').addGdocFileSn and impagadaSn is defined and impagadaSn == false %}
                                    <a href="#" class="btn btn-labeled btn-labeled-left bg-success" data-toggle="modal" data-target="#modal_añadir_fichero_fecha">Subir hoja de actuación<b><i class="icon-file-upload"></i></b></a>
                                {% endif %}
                            {% endif %}
                        </div>
                    </div>
                    <br/>
                    <!--<div class="row">
                        <div class="col-lg-12">
                            <div id="tree2" style="border: 1px solid #DDD; border-radius: 5px; padding:20px; margin:0 auto;"></div>
                        </div>
                    </div>-->
                    <div class="col-lg-12">
                        <div id="datatable-hojaactuacion" class="dataTables_wrapper no-footer">
                            <div class="datatable-scroll">
                                <table class="table datatable-export-excel-hojasactuacion dataTable no-footer" id="hojaactuacion" role="grid" aria-describedby="DataTables_Table_0_info" style="width: 100% !important;">
                                    <thead>
                                    <tr class="bg-grey-300" role="row">
                                        <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
                                            aria-label="Nombre archivo" aria-sort="ascending">Nombre archivo
                                        </th>
                                        <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
                                            aria-label="Fecha">{% trans %}TRANS_FECHA_MODELO_347{% endtrans %}
                                        </th>
                                        <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
                                            aria-label="Observación" aria-sort="ascending">Observaciones
                                        </th>
                                        <th class="text-center sorting_disabled" rowspan="1" colspan="1" aria-label="Actions"
                                            style="width: 100px;">{% trans from 'messages' %}TRANS_ACCIONES{% endtrans %}
                                        </th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tab-pane fade" id="tab9">
                    <div class="row">
                        <div class="col-lg-6">
                            <div id="treePuestos" style="border: 1px solid #DDD; border-radius: 5px; padding:20px; margin:0 auto;"></div>
                        </div>
                        <!--Petició 28/07/2023-->
                        <!--
                        <div class="col-lg-3">
                            <h4>{% trans from 'puestotrabajo' %}TRANS_ZONAS_TRABAJO{% endtrans %}</h4>

                            <div class="form-group">
                                <label>{% trans %}TRANS_NOMBRE{% endtrans %}</label>
                                <input type="text" id="nombreZona" class="form-control" />
                            </div>

                            <div class="form-group">
                                {% if app.session.get('privilegiosRol').addPuestoTrabajoSn is defined and app.session.get('privilegiosRol').addPuestoTrabajoSn is not null %}
                                    {% if app.session.get('privilegiosRol').addPuestoTrabajoSn %}
                                        <button type="button" id="btnAddZonaTrabajo" class="btn btn-labeled btn-labeled-left bg-grey-300">{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}<b><i class="icon-plus3"></i></b></button>
                                    {% endif %}
                                {% endif %}
                            </div>
                        </div> -->
                        <div class="col-lg-3">
                            <h4>{% trans from 'puestotrabajo' %}TRANS_PUESTOS_TRABAJO{% endtrans %}</h4>

                            <div class="form-group">
                                <label>{% trans from 'puestotrabajo' %}TRANS_PUESTO_TRABAJO_GENERICO{% endtrans %}</label>
                                <select id="puestoGenerico" class="form-control select-search">
                                    <option value=""></option>
                                    {% if listPuestosGenericos is defined and listPuestosGenericos is not empty %}
                                        {% for lpg in listPuestosGenericos %}
                                            <option value="{{ lpg.id }}">{{ lpg.descripcion }}</option>
                                        {% endfor %}
                                    {% endif %}
                                </select>
                            </div>

                            <div class="form-group">
                                <label>{% trans %}TRANS_NOMBRE{% endtrans %}</label>
                                <input type="text" id="nombrePuesto" class="form-control" />
                            </div>

                            <div class="form-group" hidden>
                                <label>{% trans %}TRANS_CODIGO{% endtrans %}</label>
                                <input type="text" id="codigo" class="form-control" />
                            </div>
                            <!--Petició 28/07/2023-->
                            <!--
                            <div class="form-group">
                                <label>{% trans from 'puestotrabajo' %}TRANS_ZONA_TRABAJO{% endtrans %}</label>
                                <select id="zonaTrabajo" class="form-control">
                                    <option value=""></option>
                                    {% if zonasTrabajo is defined and zonasTrabajo is not empty %}
                                        {% for zt in zonasTrabajo %}
                                            <option value="{{ zt.id }}">{{ zt.descripcion }}</option>
                                        {% endfor %}
                                    {% endif %}
                                </select>
                            </div>-->

                            <div class="form-group" hidden>
                                <label>{% trans from 'puestotrabajo' %}TRANS_OBSERVACIONES{% endtrans %}</label>
                                <input type="text" id="observaciones" class="form-control" />
                            </div>

                            <div class="form-group">
                                {% if app.session.get('privilegiosRol').addPuestoTrabajoSn is defined and app.session.get('privilegiosRol').addPuestoTrabajoSn is not null %}
                                    {% if app.session.get('privilegiosRol').addPuestoTrabajoSn %}
                                        <button type="button" id="btnAddPuestoTrabajo" class="btn btn-labeled btn-labeled-left bg-grey-300">{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}<b><i class="icon-plus3"></i></b></button>
                                    {% endif %}
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tab-pane fade" id="tab10">
                    <div class="row">
                        <div class="col-lg-12">
                            <h4>{% trans from 'empresas' %}TRANS_MAQUINA_GENERICA{% endtrans %}</h4>
                        </div>
                    </div>

                    {% if app.session.get('privilegiosRol').editPuestoTrabajoSn is defined and app.session.get('privilegiosRol').editPuestoTrabajoSn is not null %}
                        {% if app.session.get('privilegiosRol').editPuestoTrabajoSn %}
                            <div class="row">
                                <div class="col-lg-6">
                                    <a href="#" class="btn btn-labeled btn-labeled-left bg-grey-300" data-toggle="modal" data-target="#modal_añadir_maquina_generica_puesto_trabajo">{% trans from 'empresas' %}TRANS_AÑADIR_MAQUINARIA{% endtrans %}<b><i class="icon-plus3"></i></b></a>
                                </div>
                                <div class="col-lg-6">
                                    <a href="#" class="btn btn-labeled btn-labeled-left bg-grey-300" data-toggle="modal" data-target="#modal_añadir_maquina_generica_zona_trabajo">{% trans from 'empresas' %}TRANS_AÑADIR_MAQUINARIA{% endtrans %}<b><i class="icon-plus3"></i></b></a>
                                </div>
                            </div>
                        {% endif %}
                    {% endif %}
                    <br/>

                    <div class="row">
                        <div class="col-lg-6">
                            <div id="datatable-maquinas-genericas-puesto-trabajo" class="dataTables_wrapper no-footer">
                                <div class="datatable-scroll">
                                    <table class="table datatable-export-excel-maquinas-genericas-puesto-trabajo dataTable no-footer" role="grid"
                                           aria-describedby="DataTables_Table_0_info" style="width: 100% !important;">
                                        <thead>
                                        <tr class="bg-grey-300" role="row">
                                            <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
                                                aria-label="PuestoTrabajo">{% trans from 'puestotrabajo' %}TRANS_PUESTO_TRABAJO{% endtrans %}
                                            </th>
                                            <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
                                                aria-label="MaquinaGenerica">{% trans %}TRANS_NOMBRE{% endtrans %}
                                            </th>
                                            <th class="text-center sorting_disabled" rowspan="1" colspan="1" aria-label="Actions"
                                                style="width: 100px;">{% trans from 'messages' %}TRANS_ACCIONES{% endtrans %}
                                            </th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-6">
                            <div id="datatable-maquinas-genericas-zona-trabajo" class="dataTables_wrapper no-footer">
                                <div class="datatable-scroll">
                                    <table class="table datatable-export-excel-maquinas-genericas-zona-trabajo dataTable no-footer" role="grid"
                                           aria-describedby="DataTables_Table_0_info" style="width: 100% !important;">
                                        <thead>
                                        <tr class="bg-grey-300" role="row">
                                            <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
                                                aria-label="ZonaTrabajo">{% trans from 'puestotrabajo' %}TRANS_ZONA_TRABAJO{% endtrans %}
                                            </th>
                                            <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
                                                aria-label="MaquinaGenerica">{% trans %}TRANS_NOMBRE{% endtrans %}
                                            </th>
                                            <th class="text-center sorting_disabled" rowspan="1" colspan="1" aria-label="Actions"
                                                style="width: 100px;">{% trans from 'messages' %}TRANS_ACCIONES{% endtrans %}
                                            </th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-lg-12">
                            <h4>{% trans from 'empresas' %}TRANS_MAQUINA_EMPRESA{% endtrans %}</h4>
                        </div>
                    </div>

                    {% if app.session.get('privilegiosRol').editPuestoTrabajoSn is defined and app.session.get('privilegiosRol').editPuestoTrabajoSn is not null %}
                        {% if app.session.get('privilegiosRol').editPuestoTrabajoSn %}
                            <div class="row">
                                <div class="col-lg-6">
                                    <a href="#" class="btn btn-labeled btn-labeled-left bg-grey-300" data-toggle="modal" data-target="#modal_añadir_maquina_empresa_puesto_trabajo">{% trans from 'empresas' %}TRANS_AÑADIR_MAQUINARIA{% endtrans %}<b><i class="icon-plus3"></i></b></a>
                                </div>
                                <div class="col-lg-6">
                                    <a href="#" class="btn btn-labeled btn-labeled-left bg-grey-300" data-toggle="modal" data-target="#modal_añadir_maquina_empresa_zona_trabajo">{% trans from 'empresas' %}TRANS_AÑADIR_MAQUINARIA{% endtrans %}<b><i class="icon-plus3"></i></b></a>
                                </div>
                            </div>
                        {% endif %}
                    {% endif %}
                    <br/>

                    <div class="row">
                        <div class="col-lg-6">
                            <div id="datatable-maquinas-empresa-puesto-trabajo" class="dataTables_wrapper no-footer">
                                <div class="datatable-scroll">
                                    <table class="table datatable-export-excel-maquinas-empresa-puesto-trabajo dataTable no-footer" role="grid"
                                           aria-describedby="DataTables_Table_0_info" style="width: 100% !important;">
                                        <thead>
                                        <tr class="bg-grey-300" role="row">
                                            <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
                                                aria-label="PuestoTrabajo">{% trans from 'puestotrabajo' %}TRANS_PUESTO_TRABAJO{% endtrans %}
                                            </th>
                                            <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
                                                aria-label="MaquinaGenerica">{% trans %}TRANS_NOMBRE{% endtrans %}
                                            </th>
                                            <th class="text-center sorting_disabled" rowspan="1" colspan="1" aria-label="Actions"
                                                style="width: 100px;">{% trans from 'messages' %}TRANS_ACCIONES{% endtrans %}
                                            </th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-6">
                            <div id="datatable-maquinas-empresa-zona-trabajo" class="dataTables_wrapper no-footer">
                                <div class="datatable-scroll">
                                    <table class="table datatable-export-excel-maquinas-empresa-zona-trabajo dataTable no-footer" role="grid"
                                           aria-describedby="DataTables_Table_0_info" style="width: 100% !important;">
                                        <thead>
                                        <tr class="bg-grey-300" role="row">
                                            <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
                                                aria-label="ZonaTrabajo">{% trans from 'puestotrabajo' %}TRANS_ZONA_TRABAJO{% endtrans %}
                                            </th>
                                            <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
                                                aria-label="MaquinaGenerica">{% trans %}TRANS_NOMBRE{% endtrans %}
                                            </th>
                                            <th class="text-center sorting_disabled" rowspan="1" colspan="1" aria-label="Actions"
                                                style="width: 100px;">{% trans from 'messages' %}TRANS_ACCIONES{% endtrans %}
                                            </th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tab-pane fade" id="tab11">

                    <div class="row">
                        <div class="col-lg-12">
                            <h3 class="text-center">{% trans %}TRANS_REVISIONES_MEDICAS{% endtrans %}</h3>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-lg-12">
                            <div id="datatable-tarifas-revisiones" class="dataTables_wrapper no-footer">
                                <div class="datatable-scroll">
                                    <table class="table datatable-export-excel-tarifas-revisiones dataTable no-footer" id="DataTables_Table_0" role="grid" aria-describedby="DataTables_Table_0_info" style="width: 100% !important;">
                                        <thead>
                                        <tr class="bg-grey-300" role="row">
                                            <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
                                                aria-label="Concepto" aria-sort="ascending">{% trans from 'facturacion' %}TRANS_CONCEPTO{% endtrans %}
                                            </th>
                                            <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
                                                aria-label="Iva" >{% trans from 'facturacion' %}TRANS_IVA{% endtrans %}
                                            </th>
                                            <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
                                                aria-label="Importe" >{% trans from 'facturacion' %}TRANS_IMPORTE_TOTAL{% endtrans %}
                                            </th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tab-pane fade" id="tab12">
                    <div class="row">
                        <div class="col-lg-12">
                            {% if app.session.get('privilegiosRol').addProtocoloAcosoSn is defined and app.session.get('privilegiosRol').addProtocoloAcosoSn is not null %}
                                {% if app.session.get('privilegiosRol').addProtocoloAcosoSn and impagadaSn is defined and impagadaSn == false %}
                                    <a href="#" class="btn btn-labeled btn-labeled-left bg-grey-300" data-toggle="modal" data-target="#modal_añadir_protocolo_acoso">{% trans %}TRANS_NUEVO_PROTOCOLO_ACOSO{% endtrans %}<b><i class="icon-plus3"></i></b></a>
                                {% endif %}
                            {% endif %}
                        </div>
                    </div>
                    <br/>
                    <div class="row">
                        <div class="col-lg-12">
                            <div id="datatable-protocolo-acoso" class="dataTables_wrapper no-footer">
                                <div class="datatable-scroll">
                                    <table class="table datatable-export-excel-protocolo-acoso dataTable no-footer" id="protocoloAcoso" role="grid"
                                           aria-describedby="DataTables_Table_0_info" style="width: 100% !important;">
                                        <thead>
                                        <tr class="bg-grey-300" role="row">
                                            <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1"
                                                aria-label="Fecha">{% trans %}TRANS_FECHA_MODELO_347{% endtrans %}
                                            </th>
                                            <th class="text-center sorting_disabled" rowspan="1" colspan="1" aria-label="Actions"
                                                style="width: 100px;">{% trans from 'messages' %}TRANS_ACCIONES{% endtrans %}
                                            </th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>

            <div class="card-footer d-flex justify-content-between align-items-center border-top-0">
                {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn is defined and app.session.get('privilegiosRol').editEmpresaTecnicoSn is not null %}
                    {% if app.session.get('privilegiosRol').editEmpresaTecnicoSn and impagadaSn is defined and impagadaSn == false %}
                        {{ form_row(form.guardar) }}
                    {% else %}
                        {{ form_row(form.guardar, {'attr': {'style': 'display: none;'}}) }}
                    {% endif %}
                {% else %}
                    {{ form_row(form.guardar, {'attr': {'style': 'display: none;'}}) }}
                {% endif %}
            </div>

            {{ form_end(form) }}
        </div>

        <!-- Modal añadir cnae -->
        <div id="modal_añadir_cnae" class="modal fade" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">{% trans %}TRANS_AÑADIR_CNAE{% endtrans %}</h5>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>

                    <div class="modal-body">
                        <label>{% trans %}TRANS_CNAE{% endtrans %}</label>
                        <select id="cnaeValor" class="select-search form-control">
                            <option value=""></option>
                            {% if listCnae is not empty %}
                                {% for lc in listCnae %}
                                    <option value="{{ lc.id }}">{{ lc.cnae }} - {{ lc.descripcion }}</option>
                                {% endfor %}
                            {% endif %}
                        </select>

                        <br/>
                        <br/>

                        <div class="form-check">
                            <input type="checkbox" id="principal" name="principal" class="form-check-input-styled form-check-input" value="1" checked="checked" />
                            <label class="form-check-label" for="principal">Principal</label>
                        </div>

                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn bg-primary" id="btnAddCnae">{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Modal añadir cnae -->

        <!-- Modal editar cnae -->
        <div id="modal_editar_cnae" class="modal fade" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">{% trans %}TRANS_EDITAR_CNAE{% endtrans %}</h5>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>
                    <div class="modal-body">
                        <label>{% trans %}TRANS_CNAE{% endtrans %}</label>
                        <select id="cnaeValorEditar" class="select-search form-control">
                            <option value=""></option>
                            {% if listCnae is not empty %}
                                {% for lc in listCnae %}
                                    <option value="{{ lc.id }}">{{ lc.cnae }} - {{ lc.descripcion }}</option>
                                {% endfor %}
                            {% endif %}
                        </select>

                        <br/>
                        <br/>

                        <div class="form-check">
                            <input type="checkbox" id="principalEditar" name="principalEditar" class="form-check-input-styled form-check-input" value="1" checked="checked" />
                            <label class="form-check-label" for="principal">Principal</label>
                        </div>

                        <input type="hidden" id="cnaeEmpresaIdEditar" />
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn bg-primary" id="btnUpdateCnae">Guardar</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Modal editar cnae -->

        <!-- Modal añadir trabajador -->
        <div id="modal_añadir_trabajador" class="modal fade">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">{% trans %}TRANS_AÑADIR_TRABAJADOR{% endtrans %}</h5>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>

                    <div class="modal-body">
                        <label>{% trans %}TRANS_TRABAJADOR{% endtrans %}</label>
                        <select id="trabajadorEmpresa" class="form-control js_busca_ajax_trabajador" data-fouc>
                        </select>

                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn bg-primary" id="btnAddTrabajador">{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Modal añadir trabajador -->

        <!-- Modal añadir puesto trabajo multiple -->
        <div id="modal_añadir_puesto_trabajo_multiple" class="modal fade">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">{% trans %}TRANS_ASIGNAR_PUESTO_TRABAJO_MULTIPLE{% endtrans %}</h5>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>

                    <div class="modal-body">
                        <label>{% trans %}TRANS_TRABAJADOR{% endtrans %}</label>
                        <select id="trabajadorPuestoTrabajoMultiple" class="select-search form-control" multiple>
                            <option value=""></option>
                            {% if listTrabajadoresEmpresa is not empty %}
                                {% for te in listTrabajadoresEmpresa %}
                                    {% if te.trabajador is not empty %}
                                        <option value="{{ te.trabajador.id }}">{{ te.trabajador.nombre }}</option>
                                    {% endif %}
                                {% endfor %}
                            {% endif %}
                        </select>

                        <br/>
                        <br/>

                        <label>{% trans from 'revision' %}TRANS_PUESTO_TRABAJO{% endtrans %}</label>
                        <select id="puestoPuestoTrabajoMultiple" class="select-search form-control">
                            <option value=""></option>
                            {% if listPuestosTrabajo is not empty %}
                                {% for lpt in listPuestosTrabajo %}
                                    <option value="{{ lpt.id }}">{{ lpt.descripcion }}</option>
                                {% endfor %}
                            {% endif %}
                        </select>

                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn bg-primary" id="btnAddPuestoTrabajoMultiple">{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Modal puesto trabajo multiple -->

        <!-- Modal añadir centro -->
        <div id="modal_añadir_centro" class="modal fade">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">{% trans %}TRANS_AÑADIR_CENTRO{% endtrans %}</h5>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>

                    <div class="modal-body">
                        <label>{% trans %}TRANS_CENTRO_TRABAJO{% endtrans %}</label>
                        <select id="centroTrabajo" class="form-control js_busca_ajax_centro" data-fouc>
                        </select>
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn bg-primary" id="btnAddCentroTrabajoEmpresa">{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Modal añadir centro -->

        <!-- Modal añadir accidente -->
        <div id="modal_añadir_accidente" class="modal fade">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">{% trans %}TRANS_AÑADIR_ACCIDENTE{% endtrans %}</h5>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>

                    <div class="modal-body">
                        <label>{% trans %}TRANS_FECHA_MODELO_347{% endtrans %}</label>
                        <input type="date" id="dtAccidenteLaboral" placeholder="dd/mm/aaaa" class="form-control">
                        <br/>

                        <label>{% trans %}TRANS_TRABAJADOR{% endtrans %}</label>
                        <select id="trabajadorAccidente" class="select-search form-control">
                            <option value=""></option>
                            {% if listTrabajadoresEmpresa is not empty %}
                                {% for te in listTrabajadoresEmpresa %}
                                    {% if te.trabajador is not empty %}
                                        <option value="{{ te.trabajador.id }}">{{ te.trabajador.nombre }}</option>
                                    {% endif %}
                                {% endfor %}
                            {% endif %}
                        </select>

                        <br/>

                        <label>{% trans %}TRANS_PLANTILLA{% endtrans %}</label>
                        <select id="plantillaAccidente" class="select-search form-control">
                            <option value=""></option>
                            {% if listPlantillaAccidentes is not empty %}
                                {% for lpa in listPlantillaAccidentes %}
                                    <option value="{{ lpa.id }}">{{ lpa.nombre }}</option>
                                {% endfor %}
                            {% endif %}
                        </select>
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn bg-primary" id="btnGeneraAccidente">{% trans from 'messages' %}TRANS_IMPRIMIR{% endtrans %}</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Modal añadir accidente -->

        <!-- Modal añadir correo -->
        <div id="modal_añadir_email" class="modal fade" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">{% trans %}TRANS_AÑADIR_CORREO{% endtrans %}</h5>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>

                    <div class="modal-body">
                        <label>{% trans %}TRANS_EMAIL{% endtrans %}</label>
                        <input type="text" id="email" class="form-control" />

                        <label>{% trans %}TRANS_FUNCION_EMAIL{% endtrans %}</label>
                        <select id="funcion" class="select-search form-control">
                            <option value=""></option>
                            {% if listFuncionCorreo is not empty %}
                                {% for lf in listFuncionCorreo %}
                                    <option value="{{ lf.id }}">{{ lf.descripcion }}</option>
                                {% endfor %}
                            {% endif %}
                        </select>
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn bg-primary" id="btnAddCorreo">{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Modal añadir correo -->

        <!-- Modal editar correo -->
        <div id="modal_editar_email" class="modal fade" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">{% trans %}TRANS_EDITAR_CORREO{% endtrans %}</h5>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>

                    <div class="modal-body">
                        <label>{% trans %}TRANS_EMAIL{% endtrans %}</label>
                        <input type="text" id="emailEditar" class="form-control" />

                        <label>{% trans %}TRANS_FUNCION_EMAIL{% endtrans %}</label>
                        <select id="funcionEditar" class="select-search form-control">
                            <option value=""></option>
                            {% if listFuncionCorreo is not empty %}
                                {% for lf in listFuncionCorreo %}
                                    <option value="{{ lf.id }}">{{ lf.descripcion }}</option>
                                {% endfor %}
                            {% endif %}
                        </select>

                        <input type="hidden" id="correoEmpresaIdEditar" />
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn bg-primary" id="btnUpdateCorreo">Guardar</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Modal editar correo -->

        <!-- Modal añadir tecnico -->
        <div id="modal_añadir_tecnico" class="modal fade" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">{% trans %}TRANS_AÑADIR_TECNICO{% endtrans %}</h5>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>

                    <div class="modal-body">
                        <label>{% trans %}TRANS_TECNICO{% endtrans %}</label>
                        <select id="tecnico" class="select-search form-control">
                            <option value=""></option>
                            {% if listTecnicos is not empty %}
                                {% for lt in listTecnicos %}
                                    <option value="{{ lt.id }}">{{ lt.nombre }}</option>
                                {% endfor %}
                            {% endif %}
                        </select>
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn bg-primary" id="btnAddTecnico">{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Modal añadir tecnico -->

        <!-- Modal editar tecnico -->
        <div id="modal_editar_tecnico" class="modal fade" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">{% trans %}TRANS_EDITAR_TECNICO{% endtrans %}</h5>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>

                    <div class="modal-body">
                        <label>{% trans %}TRANS_TECNICO{% endtrans %}</label>
                        <select id="tecnicoEditar" class="select-search form-control">
                            <option value=""></option>
                            {% if listTecnicos is not empty %}
                                {% for lt in listTecnicos %}
                                    <option value="{{ lt.id }}">{{ lt.nombre }}</option>
                                {% endfor %}
                            {% endif %}
                        </select>
                        <input type="hidden" id="tecnicoEmpresaId" />
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn bg-primary" id="btnUpdateTecnico">Guardar</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Modal editar tecnico -->

        <!-- Modal añadir plan de prevencion -->
        <div id="modal_añadir_plan_prevencion" class="modal fade">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">{% trans %}TRANS_AÑADIR_PLAN_PREVENCION{% endtrans %}</h5>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>
                    <div class="modal-body">
                        <label>{% trans %}TRANS_FECHA_MODELO_347{% endtrans %}</label>
                        <input type="date" id="dtPlanPrevencion" placeholder="dd/mm/aaaa" class="form-control">
                        <br/>

                        <label>{% trans %}TRANS_PLANTILLA{% endtrans %}</label>
                        <select name="select2" id="plantillaPlanPrevencion" class="select-search form-control">
                            <option value=""></option>
                            {% if listPlantillaPlanPrevencion is not empty %}
                                {% for lpp in listPlantillaPlanPrevencion %}
                                    <option value="{{ lpp.id }}">{{ lpp.nombre }}</option>
                                {% endfor %}
                            {% endif %}
                        </select>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn bg-primary" id="btnGeneraPlanPrevencion">{% trans from 'messages' %}TRANS_IMPRIMIR{% endtrans %}</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Modal añadir plan de prevencion -->

        <!-- Modal añadir protocolo acoso -->
        <div id="modal_añadir_protocolo_acoso" class="modal fade">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">{% trans %}TRANS_AÑADIR_PLAN_PREVENCION{% endtrans %}</h5>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>
                    <div class="modal-body">
                        <label>{% trans %}TRANS_FECHA_MODELO_347{% endtrans %}</label>
                        <input type="date" id="dtProtocoloAcoso" placeholder="dd/mm/aaaa" class="form-control">
                        <br/>

                        <label>{% trans %}TRANS_PLANTILLA{% endtrans %}</label>
                        <select id="plantillaProtocoloAcoso" class="select-search form-control">
                            <option value=""></option>
                            {% if listPlantillasProtocoloAcoso is not empty %}
                                {% for lppa in listPlantillasProtocoloAcoso %}
                                    <option value="{{ lppa.id }}">{{ lppa.nombre }}</option>
                                {% endfor %}
                            {% endif %}
                        </select>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn bg-primary" id="btnGeneraProtocoloAcoso">{% trans from 'messages' %}TRANS_IMPRIMIR{% endtrans %}</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Modal añadir protocolo acoso -->

        <!-- Modal añadir carpeta -->
        <div id="modal_añadir_carpeta" class="modal fade" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">{% trans from 'gdoc' %}TRANS_ADD_CARPETA{% endtrans %}</h5>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>

                    <div class="modal-body">
                        <label>{% trans from 'gdoc' %}TRANS_NOMBRE_CARPETA{% endtrans %}</label>
                        <input type="text" id="nombreCarpeta" class="form-control" />

                        <label>{% trans from 'gdoc' %}TRANS_PADRE{% endtrans %}</label>
                        <select id="carpetaPadre" class="select-search form-control">
                            <option value=""></option>
                            {% if carpetas is not empty %}
                                {% for c in carpetas %}
                                    <option value="{{ c.id }}">{{ c.nombre }}</option>
                                {% endfor %}
                            {% endif %}
                        </select>

                    </div>

                    <div class="modal-footer">
                        {% if app.session.get('privilegiosRol').addGdocSn is defined and app.session.get('privilegiosRol').addGdocSn is not null %}
                            {% if app.session.get('privilegiosRol').addGdocSn and impagadaSn is defined and impagadaSn == false %}
                                <button type="button" class="btn bg-primary" id="btnAddCarpeta">{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}</button>
                            {% endif %}
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        <!-- Modal añadir carpeta -->

        <!-- Modal editar carpeta -->
        <div id="modal_editar_carpeta" class="modal fade" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">{% trans from 'gdoc' %}TRANS_EDIT_CARPETA{% endtrans %}</h5>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>

                    <div class="modal-body">
                        <label>{% trans from 'gdoc' %}TRANS_NOMBRE_CARPETA{% endtrans %}</label>
                        <input type="text" id="nombreCarpetaEditar" class="form-control" />

                        <label>{% trans from 'gdoc' %}TRANS_PADRE{% endtrans %}</label>
                        <select id="carpetaPadreEditar" class="select-search form-control">
                            <option value=""></option>
                            {% if carpetas is defined and carpetas is not empty %}
                                {% for c in carpetas %}
                                    <option value="{{ c.id }}">{{ c.nombre }}</option>
                                {% endfor %}
                            {% endif %}
                        </select>

                        <input type="hidden" id="idCarpeta" class="form-control" />

                    </div>

                    <div class="modal-footer">
                        {% if app.session.get('privilegiosRol').editGdocSn is defined and app.session.get('privilegiosRol').editGdocSn is not null %}
                            {% if app.session.get('privilegiosRol').editGdocSn and impagadaSn is defined and impagadaSn == false %}
                                <button type="button" class="btn bg-primary" id="btnUpdateCarpeta">Guardar</button>
                            {% endif %}
                        {% endif %}
                        {% if app.session.get('privilegiosRol').deleteGdocSn is defined and app.session.get('privilegiosRol').deleteGdocSn is not null %}
                            {% if app.session.get('privilegiosRol').deleteGdocSn and impagadaSn is defined and impagadaSn == false %}
                                <button type="button" class="btn bg-danger" id="btnDeleteCarpeta">Eliminar</button>
                            {% endif %}
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        <!-- Modal editar carpeta -->

        <!-- Modal view fichero -->
        <div id="modal_view_fichero" class="modal fade" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">{% trans from 'gdoc' %}TRANS_DATOS_FICHERO{% endtrans %}</h5>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>

                    <div class="modal-body">
                        <label>{% trans from 'gdoc' %}TRANS_NOMBRE_FICHERO{% endtrans %}</label>
                        <input type="text" id="nombreFichero" class="form-control" disabled="disabled" />

                        <label>{% trans from 'gdoc' %}TRANS_FECHA_FICHERO{% endtrans %}</label>
                        <input type="text" id="fechaFichero" class="form-control" disabled="disabled" />

                        <label>{% trans from 'gdoc' %}TRANS_NOMBRE_USUARIO_FICHERO{% endtrans %}</label>
                        <input type="text" id="usuarioFichero" class="form-control" disabled="disabled" />

                        <label>{% trans from 'gdoc' %}TRANS_TIPO_FICHERO{% endtrans %}</label>
                        <input type="text" id="tipoFichero" class="form-control" disabled="disabled" />

                        <label>{% trans from 'gdoc' %}TRANS_MIDA_FICHERO{% endtrans %}</label>
                        <input type="text" id="midaFichero" class="form-control" disabled="disabled" />

                        <input type="hidden" id="idFichero" class="form-control" />

                    </div>

                    <div class="modal-footer">

                        {% if app.session.get('privilegiosRol').openGdocFileSn is defined and app.session.get('privilegiosRol').openGdocFileSn is not null %}
                            {% if app.session.get('privilegiosRol').openGdocFileSn and impagadaSn is defined and impagadaSn == false %}
                                {% if app.session.get('empresa') is defined and app.session.get('empresa') is not null %}
                                    <a href="#" id="btnOpenPlantilla" class="btn btn-labeled btn-labeled-left bg-primary" target="_blank">{% trans from 'messages' %}TRANS_OPEN{% endtrans %}<b><i class="icon-file-eye"></i></b></a>
                                {% else %}
                                    <a href="#" class="btn btn-labeled btn-labeled-left bg-primary noEmpresa">{% trans from 'messages' %}TRANS_OPEN{% endtrans %}<b><i class="icon-file-eye"></i></b></a>
                                {% endif %}
                            {% endif %}
                        {% endif %}

                        {% if app.session.get('privilegiosRol').downGdocFileSn is defined and app.session.get('privilegiosRol').downGdocFileSn is not null %}
                            {% if app.session.get('privilegiosRol').downGdocFileSn and impagadaSn is defined and impagadaSn == false %}
                                <a href="#" id="btnDownPlantilla" class="btn btn-labeled btn-labeled-left bg-success" target="_blank">{% trans from 'messages' %}TRANS_DOWN{% endtrans %}<b><i class="icon-file-download"></i></b></a>
                            {% endif %}
                        {% endif %}

                        {% if app.session.get('privilegiosRol').deleteGdocFileSn is defined and app.session.get('privilegiosRol').deleteGdocFileSn is not null %}
                            {% if app.session.get('privilegiosRol').deleteGdocFileSn and impagadaSn is defined and impagadaSn == false %}
                                <button type="button" class="btn btn-labeled btn-labeled-left bg-danger" id="btnDeletePlantilla">{% trans from 'messages' %}TRANS_ELIMINAR{% endtrans %}<b><i class="icon-cross2"></i></b></button>
                            {% endif %}
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        <!-- Modal view fichero -->
        <!-- Modal añadir fichero Peticio 01/09/2023 -->
        <div id="modal_añadir_fichero_fecha" class="modal fade" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">{% trans from 'gdoc' %}TRANS_AÑADIR_FICHERO{% endtrans %}</h5>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>

                    <div class="modal-body">
                        {{ form_start(form4) }}

                        <div class="row">
                            <div class="col-lg-12">
                                {{ form_row(form4.media) }}
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-lg-12" hidden>
                                {{ form_row(form4.carpeta) }}
                            </div>
                        </div>

                        {{ form_end(form4) }}

                    </div>

                    <div class="modal-footer">
                        {% if app.session.get('privilegiosRol').addGdocSn is defined and app.session.get('privilegiosRol').addGdocSn is not null %}
                            {% if app.session.get('privilegiosRol').addGdocSn and impagadaSn is defined and impagadaSn == false %}
                                {{ form_row(form4.guardar) }}
                            {% else %}
                                {{ form_row(form4.guardar, {'attr': {'style': 'display: none;'}}) }}
                            {% endif %}
                        {% else %}
                            {{ form_row(form4.guardar, {'attr': {'style': 'display: none;'}}) }}
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        <!-- Modal añadir fichero -->
        <div id="modal_añadir_fichero" class="modal fade" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">{% trans from 'gdoc' %}TRANS_AÑADIR_FICHERO{% endtrans %}</h5>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>

                    <div class="modal-body">
                        {{ form_start(form2) }}

                        <div class="row">
                            <div class="col-lg-12">
                                {{ form_row(form2.nombre) }}
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-lg-12">
                                {{ form_row(form2.media) }}
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-lg-12">
                                {{ form_row(form2.carpeta) }}
                            </div>
                        </div>

                        {{ form_end(form2) }}

                    </div>

                    <div class="modal-footer">
                        {% if app.session.get('privilegiosRol').addGdocSn is defined and app.session.get('privilegiosRol').addGdocSn is not null %}
                            {% if app.session.get('privilegiosRol').addGdocSn and impagadaSn is defined and impagadaSn == false %}
                                {{ form_row(form2.guardar) }}
                            {% else %}
                                {{ form_row(form2.guardar, {'attr': {'style': 'display: none;'}}) }}
                            {% endif %}
                        {% else %}
                            {{ form_row(form2.guardar, {'attr': {'style': 'display: none;'}}) }}
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        <!-- Modal añadir fichero -->

        <!-- Modal modificar zona -->
        <div id="modal_editar_zona" class="modal fade">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">{% trans from 'puestotrabajo' %}TRANS_MODIFICAR_ZONA_TRABAJO{% endtrans %}</h5>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>

                    <div class="modal-body">
                        <label>{% trans from 'empresas' %}TRANS_NOMBRE{% endtrans %}</label>
                        <input type="text" id="nombreZonaEdit" class="form-control" />
                        <input type="hidden" id="zonaIdEdit" class="form-control" />
                    </div>

                    <div class="modal-footer">
                        {% if app.session.get('privilegiosRol').editPuestoTrabajoSn is defined and app.session.get('privilegiosRol').editPuestoTrabajoSn is not null %}
                            {% if app.session.get('privilegiosRol').editPuestoTrabajoSn %}
                                <button type="button" class="btn btn-labeled btn-labeled-left bg-primary" id="btnUpdateZonaTrabajo">Guardar<b><i class="icon-pencil7"></i></b></button>
                            {% endif %}
                        {% endif %}

                        {% if app.session.get('privilegiosRol').deletePuestoTrabajoSn is defined and app.session.get('privilegiosRol').deletePuestoTrabajoSn is not null %}
                            {% if app.session.get('privilegiosRol').deletePuestoTrabajoSn %}
                                <button type="button" class="btn btn-labeled btn-labeled-left bg-danger" id="btnDeleteZonaTrabajo">Eliminar<b><i class="icon-cross2"></i></b></button>
                            {% endif %}
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        <!-- /Modal modificar zona -->

        <!-- Modal modificar puesto de trabajo -->
        <div id="modal_editar_puesto_trabajo" class="modal fade">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">{% trans from 'puestotrabajo' %}TRANS_MODIFICAR_PUESTO_TRABAJO{% endtrans %}</h5>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>

                    <div class="modal-body">

                        <div class="form-group">
                            <label>{% trans from 'puestotrabajo' %}TRANS_PUESTO_TRABAJO_GENERICO{% endtrans %}</label>
                            <select id="puestoGenericoEdit" class="form-control select-search">
                                <option value=""></option>
                                {% if listPuestosGenericos is defined and listPuestosGenericos is not empty %}
                                    {% for lpg in listPuestosGenericos %}
                                        <option value="{{ lpg.id }}">{{ lpg.descripcion }}</option>
                                    {% endfor %}
                                {% endif %}
                            </select>
                        </div>

                        <div class="form-group">
                            <label>{% trans from 'puestotrabajo' %}TRANS_NOMBRE{% endtrans %}</label>
                            <input type="text" id="nombrePuestoEdit" class="form-control" />
                        </div>

                        <div class="form-group">
                            <label>{% trans %}TRANS_CODIGO{% endtrans %}</label>
                            <input type="text" id="codigoEdit" class="form-control" />
                        </div>

                        <div class="form-group">
                            <label>{% trans from 'puestotrabajo' %}TRANS_ZONA_TRABAJO{% endtrans %}</label>
                            <select id="zonaTrabajoEdit" class="form-control">
                                <option value=""></option>
                                {% if zonasTrabajo is defined and zonasTrabajo is not empty %}
                                    {% for zt in zonasTrabajo %}
                                        <option value="{{ zt.id }}">{{ zt.descripcion }}</option>
                                    {% endfor %}
                                {% endif %}
                            </select>
                        </div>

                        <div class="form-group">
                            <label>{% trans from 'puestotrabajo' %}TRANS_OBSERVACIONES{% endtrans %}</label>
                            <input type="text" id="observacionesEdit" class="form-control" />
                        </div>

                        <input type="hidden" id="puestoTrabajoIdEdit" class="form-control" />
                    </div>

                    <div class="modal-footer">
                        {% if app.session.get('privilegiosRol').editPuestoTrabajoSn is defined and app.session.get('privilegiosRol').editPuestoTrabajoSn is not null %}
                            {% if app.session.get('privilegiosRol').editPuestoTrabajoSn %}
                                <button type="button" class="btn btn-labeled btn-labeled-left bg-primary" id="btnUpdatePuestoTrabajo">Guardar<b><i class="icon-pencil7"></i></b></button>
                            {% endif %}
                        {% endif %}

                        {% if app.session.get('privilegiosRol').deletePuestoTrabajoSn is defined and app.session.get('privilegiosRol').deletePuestoTrabajoSn is not null %}
                            {% if app.session.get('privilegiosRol').deletePuestoTrabajoSn %}
                                <button type="button" class="btn btn-labeled btn-labeled-left bg-danger" id="btnDeletePuestoTrabajo">Eliminar<b><i class="icon-cross2"></i></b></button>
                            {% endif %}
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        <!-- /Modal modificar puesto de trabajo -->

        <!-- Modal añadir maquina generica puesto trabajo -->
        <div id="modal_añadir_maquina_generica_puesto_trabajo" class="modal fade">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">{% trans from 'empresas' %}TRANS_AÑADIR_MAQUINARIA{% endtrans %}</h5>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>

                    <div class="modal-body">
                        <label>{% trans from 'puestotrabajo' %}TRANS_PUESTO_TRABAJO{% endtrans %}</label>
                        <select id="puestoTrabajoMaquinaGenerica" class="select-search form-control">
                            <option value=""></option>
                            {% if listPuestosTrabajo is not empty %}
                                {% for lpt in listPuestosTrabajo %}
                                    <option value="{{ lpt.id }}">{{ lpt.descripcion }}</option>
                                {% endfor %}
                            {% endif %}
                        </select>

                        <br/>

                        <label>{% trans from 'empresas' %}TRANS_MAQUINARIA_GENERICA{% endtrans %}</label>
                        <select id="maquinaGenericaPuestoTrabajo" class="select-search form-control">
                            <option value=""></option>
                            {% if listMaquinasGenericas is not empty %}
                                {% for lmg in listMaquinasGenericas %}
                                    <option value="{{ lmg.id }}">{{ lmg.descripcion }}</option>
                                {% endfor %}
                            {% endif %}
                        </select>
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn bg-primary" id="btnAddMaquinaGenericaPuestoTrabajo">{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Modal añadir maquina generica puesto trabajo -->

        <!-- Modal añadir maquina generica zona trabajo -->
        <div id="modal_añadir_maquina_generica_zona_trabajo" class="modal fade">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">{% trans from 'empresas' %}TRANS_AÑADIR_MAQUINARIA{% endtrans %}</h5>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>

                    <div class="modal-body">
                        <label>{% trans from 'puestotrabajo' %}TRANS_ZONA_TRABAJO{% endtrans %}</label>
                        <select id="zonaTrabajoMaquinaGenerica" class="select-search form-control">
                            <option value=""></option>
                            {% if listZonasTrabajo is not empty %}
                                {% for lzt in listZonasTrabajo %}
                                    <option value="{{ lzt.id }}">{{ lzt.descripcion }}</option>
                                {% endfor %}
                            {% endif %}
                        </select>

                        <br/>

                        <label>{% trans from 'empresas' %}TRANS_MAQUINARIA_GENERICA{% endtrans %}</label>
                        <select id="maquinaGenericaZonaTrabajo" class="select-search form-control">
                            <option value=""></option>
                            {% if listMaquinasGenericas is not empty %}
                                {% for lmg in listMaquinasGenericas %}
                                    <option value="{{ lmg.id }}">{{ lmg.descripcion }}</option>
                                {% endfor %}
                            {% endif %}
                        </select>
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn bg-primary" id="btnAddMaquinaGenericaZonaTrabajo">{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Modal añadir maquina generica zona trabajo -->

        <!-- Modal añadir maquina empresa puesto trabajo -->
        <div id="modal_añadir_maquina_empresa_puesto_trabajo" class="modal fade">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">{% trans from 'empresas' %}TRANS_AÑADIR_MAQUINARIA{% endtrans %}</h5>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>

                    <div class="modal-body">
                        <label>{% trans from 'puestotrabajo' %}TRANS_PUESTO_TRABAJO{% endtrans %}</label>
                        <select id="puestoTrabajoMaquinaEmpresa" class="select-search form-control">
                            <option value=""></option>
                            {% if listPuestosTrabajo is not empty %}
                                {% for lpt in listPuestosTrabajo %}
                                    <option value="{{ lpt.id }}">{{ lpt.descripcion }}</option>
                                {% endfor %}
                            {% endif %}
                        </select>

                        <br/>

                        <label>{% trans from 'empresas' %}TRANS_MAQUINA_EMPRESA{% endtrans %}</label>
                        <select id="maquinaEmpresaPuestoTrabajo" class="select-search form-control">
                            <option value=""></option>
                            {% if listMaquinasEmpresa is not empty %}
                                {% for lme in listMaquinasEmpresa %}
                                    <option value="{{ lme.id }}">{{ lme.descripcion }}</option>
                                {% endfor %}
                            {% endif %}
                        </select>
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn bg-primary" id="btnAddMaquinaEmpresaPuestoTrabajo">{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Modal añadir maquina empresa puesto trabajo -->

        <!-- Modal añadir maquina empresa zona trabajo -->
        <div id="modal_añadir_maquina_empresa_zona_trabajo" class="modal fade">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">{% trans from 'empresas' %}TRANS_AÑADIR_MAQUINARIA{% endtrans %}</h5>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>

                    <div class="modal-body">
                        <label>{% trans from 'puestotrabajo' %}TRANS_ZONA_TRABAJO{% endtrans %}</label>
                        <select id="zonaTrabajoMaquinaEmpresa" class="select-search form-control">
                            <option value=""></option>
                            {% if listZonasTrabajo is not empty %}
                                {% for lzt in listZonasTrabajo %}
                                    <option value="{{ lzt.id }}">{{ lzt.descripcion }}</option>
                                {% endfor %}
                            {% endif %}
                        </select>

                        <br/>

                        <label>{% trans from 'empresas' %}TRANS_MAQUINA_EMPRESA{% endtrans %}</label>
                        <select id="maquinaEmpresaZonaTrabajo" class="select-search form-control">
                            <option value=""></option>
                            {% if listMaquinasEmpresa is not empty %}
                                {% for lme in listMaquinasEmpresa %}
                                    <option value="{{ lme.id }}">{{ lme.descripcion }}</option>
                                {% endfor %}
                            {% endif %}
                        </select>
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn bg-primary" id="btnAddMaquinaEmpresaZonaTrabajo">{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Modal añadir maquina empresa zona trabajo -->

        <!-- Modal import trabajador -->
        <div id="modal_import_trabajador" class="modal fade">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">{% trans from 'trabajadores' %}TRANS_IMPORTAR_TRABAJADORES{% endtrans %}</h5>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>

                    <div class="modal-body">

                        {% if form3 is defined and form3 is not empty %}

                        {{ form_start(form3) }}

                        {{ form_row(form3.fichero) }}

                        <div class="alert alert-info bg-white alert-styled-left alert-arrow-left alert-dismissible">
                            {% trans from 'trabajadores' %}TRANS_PROCESO_DURACION{% endtrans %}
                        </div>

                    </div>

                    <div class="modal-footer">
                        {% if app.session.get('privilegiosRol').importTrabajadorSn is defined and app.session.get('privilegiosRol').importTrabajadorSn is not null %}
                            {% if app.session.get('privilegiosRol').importTrabajadorSn %}
                                {{ form_row(form3.importar) }}
                            {% else %}
                                {{ form_row(form3.importar, {'attr': {'style': 'display: none;'}}) }}
                            {% endif %}
                        {% else %}
                            {{ form_row(form3.importar, {'attr': {'style': 'display: none;'}}) }}
                        {% endif %}
                    </div>

                    {{ form_end(form3) }}
                    {% endif %}
                </div>
            </div>
        </div>
        <!-- /Modal import trabajador -->

        <!-- Modal crear evaluacion -->
        <div id="mdal_crear_evaluacion" class="modal fade">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">{% trans from 'evaluacion' %}TRANS_NUEVA_EVALUACION{% endtrans %}</h5>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>

                    <div class="modal-body">
                        <label>{% trans from 'evaluacion' %}TRANS_TIPO{% endtrans %}</label>
                        <br/>
                        <label class='radio-inline'><input type='radio' name='tipoEvaluacion' id='tipoEvaluacion1' value='1'> {% trans from 'evaluacion' %}TRANS_EVALUACION_INICIAL{% endtrans %}</label>
                        <br/>
                        <label class='radio-inline'><input type='radio' name='tipoEvaluacion' id='tipoEvaluacion2' value='2'> {% trans from 'evaluacion' %}TRANS_EVALUACION_REVISION{% endtrans %}</label>
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn bg-primary" id="btnAddEvaluacion">{% trans from 'messages' %}TRANS_AÑADIR{% endtrans %}</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- /Modal crear evaluacion -->

{% endblock %}